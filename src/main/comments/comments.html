<ul>
    <li ng-repeat="post in posts" ng-class="{ last: $last }">

        <!--collapsed reply-->
        <div ng-if-event-expr="!post.viewFull" ng-if-event="reply-collapse" ng-if-event-id="post.id" scroll-item>
            <span class="oneline" ng-class="[post.lineClass || 'oneline9', post.tagClass]"
                  ng-click="expandReply(post)" ng-bind-html="::post.oneline | trusted"></span>
            <span class="onelineSeparator">&nbsp;:&nbsp;</span>
            <span ng-class="::post.userClass || 'user'">{{::post.author}}</span>
        </div>
        
        <!--expanded reply-->
        <div ng-if-event-expr="post.viewFull" ng-if-event="reply-collapse" ng-if-event-id="post.id">
            <div class="replyPost" ng-class="::post.tagClass" scroll-into-view>
                <post></post>
                <div class="postBody postBodyText" ng-bind-html="::post.body | trusted"></div>
            </div>

            <replybox ng-if-event-expr="post.replying" ng-if-event="post-reply" ng-if-event-id="post.threadId"
                    class="replybox-comment" post="post"></replybox>
        </div>

        <!-- replies to this post -->
        <comments posts="post.posts" flat="false" ng-if="::!flat" scroll-item></comments>
    </li>
</ul>