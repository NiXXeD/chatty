{"version":3,"sources":["app/Theme.js","context/auth/AuthContext.js","context/indicators/IndicatorContext.js","auth/LoginDialog.js","auth/LoginButton.js","auth/LogoutButton.js","userMenu/UserMenu.js","context/chatty/ChattyContext.js","nav/RefreshButton.js","util/fetchJson.js","replyBox/ReplyBox.js","nav/NewThreadButton.js","nav/MessagesButton.js","context/filter/FilterContext.js","filter/EditableList.js","filter/FilterCheckbox.js","filter/FilterDialog.js","filter/FilterButton.js","nav/Nav.js","thread/PostExpirationBar.js","thread/PostDate.js","thread/PostAuthor.js","thread/supportedTags.js","thread/Tags.js","thread/TagButton.js","thread/PostBody.js","thread/Post.js","util/bodyUtils.js","thread/OneLine.js","thread/Comments.js","thread/Thread.js","chatty/Chatty.js","app/App.js","context/auth/AuthProvider.js","context/chatty/ChattyProvider.js","context/indicators/AsyncLoadingIndicator.js","context/indicators/SyncLoadingIndicator.js","context/indicators/IndicatorProvider.js","context/clientData/ClientDataContext.js","context/filter/FilterProvider.js","history.js","context/clientData/ClientDataProvider.js","app/Root.js","index.js"],"names":["createMuiTheme","palette","type","primary","light","main","dark","secondary","typography","useNextVariants","React","createContext","LoginDialog","open","onClose","useState","username","setUsername","password","setPassword","login","useContext","AuthContext","setLoading","IndicatorContext","submit","event","a","preventDefault","Dialog","onSubmit","DialogTitle","DialogContent","TextField","autoFocus","margin","label","fullWidth","onChange","target","value","DialogActions","Button","onClick","LoginButton","setOpen","Fragment","logout","MenuItem","UserMenu","isLoggedIn","anchorEl","setAnchorEl","IconButton","keepMounted","disabled","Divider","LogoutButton","useStyles","makeStyles","badge","top","RefreshButton","classes","ChattyContext","newThreads","refreshChatty","displayBadge","length","title","Tooltip","disableFocusListener","enterDelay","Badge","badgeContent","color","url","options","body","headers","querystring","stringify","fetch","res","ok","tryJson","status","statusText","result","console","error","Promise","reject","text","JSON","parse","card","backgroundColor","borderRadius","border","actions","flexRow","display","flexDirection","textarea","flex","padding","ReplyBox","onCloseReplyBox","parentId","className","showSnackbar","setText","posting","setPosting","handleSubmit","fetchJson","method","log","variant","Card","classnames","CardHeader","CardContent","Input","multiline","disableUnderline","rows","placeholder","name","required","CardActions","dialogPaper","width","NewThreadButton","paper","MessagesButton","totalMessagesCount","setTotalMessagesCount","unreadMessagesCount","setUnreadMessagesCount","useEffect","getCounts","total","unread","id","setInterval","clearInterval","href","row","fill","container","marginTop","EditableList","editing","setEditing","itemText","setItemText","addItem","regex","RegExp","newItem","concat","ex","toLowerCase","onKeyPress","key","fontSize","Typography","disableRipple","List","dense","ListItem","ListItemText","map","item","ListItemSecondaryAction","itemToRemove","filter","checkbox","marginBottom","FilterCheckbox","checked","FormControlLabel","control","Checkbox","content","checkboxes","FilterDialog","FilterContext","filterSettings","updateFilterSettings","showCollapsed","setShowCollapsed","showFilteredTerms","setShowFilteredTerms","showFilteredUsers","setShowFilteredUsers","filteredTerms","setFilteredTerms","filteredUsers","setFilteredUsers","handleSave","FilterButton","rendered","setRendered","white","menuButton","marginLeft","marginRight","menuItem","textDecoration","Nav","drawerOpen","setDrawerOpen","closeDrawer","AppBar","elevation","Toolbar","Drawer","drawer","position","drawerAppBar","rel","wrapper","height","background","backgroundImage","backgroundSize","boxShadow","PostExpirationBar","date","now","Date","getTime","then","percent","Math","min","style","paddingTop","PostDate","parsed","parseISO","format","formatDistanceToNow","employees","mods","user","fontWeight","cursor","normal","self","op","mod","employee","PostAuthor","post","thread","author","isSameUser","one","two","left","replace","right","userClass","useMemo","find","nonBreakingAuthor","String","fromCharCode","containerPost","containerOneline","whiteSpace","chip","nonChip","lolBorder","infBorder","unfBorder","wtfBorder","tagBorder","lol","inf","unf","wtf","tag","Tags","tags","fixedTags","validTags","supportedTags","includes","miscTagCount","reduce","acc","count","Chip","TagButton","postId","toUpperCase","handleTag","tagPost","match","warn","who","what","action","params","version","response","PostBody","html","fixed","__html","dangerouslySetInnerHTML","replyBorder","replyBox","tagNws","borderLeft","tagInformative","tagFrontpage","maxWidth","header","toolbarButton","collapsed","pinned","Post","onCollapse","onPinned","replyBoxOpenForId","onOpenReplyBox","domElement","useRef","isPostVisible","tagClass","category","test","isReply","rect","current","getBoundingClientRect","viewHeight","max","document","documentElement","clientHeight","window","innerHeight","above","bottom","below","scrollTo","offsetTop","behavior","ref","lols","disableSpacing","markType","cleanAllStyles","getSnippet","input","cleanMostStyles","i","len","char","output","slice","trim","separator","oneline","overflow","textOverflow","oneline10","oneline9","oneline8","oneline7","oneline6","oneline5","oneline4","oneline3","oneline2","oneline1","OneLine","onExpandReply","lineClass","recentReplyNumber","Comments","parent","onCollapseReply","expandedReplyId","posts","truncatedMessage","borderTop","borderBottom","replyCount","truncatedContainer","truncatedComments","memo","rawThread","setExpandedReplyId","setReplyBoxOpenForId","truncated","setTruncated","setMarkType","sort","b","reverse","forEach","index","threadId","markThread","handleOpenReplyBox","handleCloseReplyBox","chatty","font","Chatty","threads","App","path","component","AuthProvider","children","storageValue","localStorage","getItem","removeItem","credentials","setCredentials","useCallback","isValid","setItem","contextValue","Provider","ChattyProvider","setChatty","lastEventId","setLastEventId","getMarkedPosts","encodeURIComponent","markedPosts","updateThreads","freshThreads","freshMarkedPosts","includeNewThreads","getChatty","nextThreads","nextNewThreads","markedPostsById","maxPostIdByThread","expireDate","subHours","isBefore","ids","join","threadCount","handleEvent","eventType","eventData","addReply","updateCategory","updates","updatedPostsById","updateTags","updated","debug","fullReload","eventId","setTimeout","mounted","waitForEvent","newerEventId","events","newChatty","progress","zIndex","AsyncLoadingIndicator","loading","LinearProgress","SyncLoadingIndicator","CircularProgress","size","thickness","IndicatorProvider","enqueueSnackbar","useSnackbar","defaultSettings","FilterProvider","ClientDataContext","clientData","updateClientData","setFilterSettings","updateCloudFilterSettings","cloudFilterSettings","cfs","some","updatedSettings","newFilterSettings","history","client","ClientDataProvider","setClientData","newClientData","data","string","loadClientData","Root","Component","ThemeProvider","theme","Theme","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.5be7efce.chunk.js","sourcesContent":["import createMuiTheme from '@material-ui/core/styles/createMuiTheme'\n\nexport default createMuiTheme({\n    palette: {\n        type: 'dark',\n        primary: {\n            light: '#6fbf73',\n            main: '#357a38',\n            dark: '#357a38'\n        },\n        secondary: {\n            light: '#33eaff',\n            main: '#00e5ff',\n            dark: '#00a0b2'\n        }\n    },\n    typography: {\n        useNextVariants: true\n    }\n})\n","import React from 'react'\n\nexport default React.createContext({})\n","import React from 'react'\n\nexport default React.createContext({})\n","import React, {useContext, useState} from 'react'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport DialogActions from '@material-ui/core/DialogActions'\nimport Button from '@material-ui/core/Button'\nimport TextField from '@material-ui/core/TextField'\nimport AuthContext from '../context/auth/AuthContext'\nimport IndicatorContext from '../context/indicators/IndicatorContext'\n\nfunction LoginDialog({open, onClose}) {\n    const [username, setUsername] = useState('')\n    const [password, setPassword] = useState('')\n    const {login} = useContext(AuthContext)\n    const {setLoading} = useContext(IndicatorContext)\n\n    const submit = async event => {\n        event.preventDefault()\n\n        try {\n            setLoading('sync')\n\n            await login(username, password)\n\n            onClose()\n        } finally {\n            setLoading(false)\n        }\n    }\n\n    return (\n        <Dialog open={open} onClose={onClose}>\n            <form onSubmit={submit}>\n                <DialogTitle>Log in</DialogTitle>\n                <DialogContent>\n                    <TextField\n                        autoFocus\n                        margin='dense'\n                        label='Username'\n                        type='text'\n                        fullWidth\n                        onChange={event => setUsername(event.target.value)}\n                    />\n                    <TextField\n                        margin='dense'\n                        label='Password'\n                        type='password'\n                        fullWidth\n                        onChange={event => setPassword(event.target.value)}\n                    />\n                </DialogContent>\n                <DialogActions>\n                    <Button onClick={onClose}>Cancel</Button>\n                    <Button type='submit'>Log in</Button>\n                </DialogActions>\n            </form>\n        </Dialog>\n    )\n}\n\nexport default LoginDialog\n","import React, {useState} from 'react'\nimport Button from '@material-ui/core/Button'\nimport LoginDialog from './LoginDialog'\n\nfunction LoginButton() {\n    const [open, setOpen] = useState(false)\n    return (\n        <React.Fragment>\n            <Button onClick={() => setOpen(true)}>Log in</Button>\n\n            <LoginDialog open={open} onClose={() => setOpen(false)}/>\n        </React.Fragment>\n    )\n}\n\nexport default LoginButton\n","import React, {useContext} from 'react'\nimport MenuItem from '@material-ui/core/MenuItem'\nimport AuthContext from '../context/auth/AuthContext'\n\nfunction LoginButton({onClick}) {\n    const {logout} = useContext(AuthContext)\n    const handleClick = () => {\n        onClick && onClick()\n        logout()\n    }\n    return <MenuItem onClick={handleClick}>Logout</MenuItem>\n}\n\nexport default LoginButton\n","import React, {useContext, useState} from 'react'\nimport Menu from '@material-ui/core/Menu'\nimport MenuItem from '@material-ui/core/MenuItem'\nimport LoginButton from '../auth/LoginButton'\nimport LogoutButton from '../auth/LogoutButton'\nimport IconButton from '@material-ui/core/IconButton'\nimport Divider from '@material-ui/core/Divider'\nimport PersonIcon from '@material-ui/icons/Person'\nimport AuthContext from '../context/auth/AuthContext'\n\nfunction UserMenu() {\n    const {isLoggedIn, username} = useContext(AuthContext)\n    const [anchorEl, setAnchorEl] = useState(null)\n\n    if (!isLoggedIn) return <LoginButton/>\n    return (\n        <React.Fragment>\n            <IconButton onClick={event => setAnchorEl(event.target)}>\n                <PersonIcon/>\n            </IconButton>\n\n            {anchorEl && <Menu\n                keepMounted\n                open={!!anchorEl}\n                anchorEl={anchorEl}\n                onClose={() => setAnchorEl(null)}\n            >\n                <MenuItem disabled>{username}</MenuItem>\n                <Divider/>\n                <LogoutButton onClick={() => setAnchorEl(null)}/>\n            </Menu>}\n        </React.Fragment>\n    )\n}\n\nexport default UserMenu\n","import React from 'react'\n\nexport default React.createContext({})\n","import React, {useContext} from 'react'\nimport IconButton from '@material-ui/core/IconButton'\nimport Tooltip from '@material-ui/core/Tooltip'\nimport RefreshIcon from '@material-ui/icons/Refresh'\nimport Badge from '@material-ui/core/Badge'\nimport ChattyContext from '../context/chatty/ChattyContext'\nimport {makeStyles} from '@material-ui/styles'\n\nfunction RefreshButton() {\n    const classes = useStyles()\n    const {newThreads, refreshChatty} = useContext(ChattyContext)\n    const displayBadge = newThreads && newThreads.length > 0\n    const title = displayBadge ? `Refresh Thread Order (${newThreads.length} new threads)` : 'Refresh Thread Order'\n\n    return (\n        <Tooltip disableFocusListener title={title} enterDelay={350}>\n            <IconButton onClick={refreshChatty}>\n                {\n                    displayBadge ?\n                        <Badge badgeContent={newThreads.length} color='secondary' classes={{badge: classes.badge}}>\n                            <RefreshIcon/>\n                        </Badge>\n                        : <RefreshIcon/>\n                }\n            </IconButton>\n        </Tooltip>\n    )\n}\n\nconst useStyles = makeStyles({\n    badge: {\n        top: 12\n    }\n})\n\nexport default RefreshButton\n","import querystring from 'querystring'\n\nconst base = 'https://winchatty.com/v2'\n\nexport default async (url, options = {}) => {\n    if (options.body) {\n        options = {\n            ...options,\n            headers: {\n                'Content-Type': 'application/x-www-form-urlencoded',\n                ...options.headers\n            },\n            body: querystring.stringify(options.body)\n        }\n    }\n    let res = await fetch(`${base}/${url}`, options)\n    if (res.ok) {\n        return await tryJson(res)\n    } else {\n        let body = await tryJson(res)\n        let {status, statusText} = res\n        let result = {status, statusText, body}\n        console.error('Http Error:', result)\n        return Promise.reject(result)\n    }\n}\n\nconst tryJson = async res => {\n    let text = await res.text()\n    try {\n        return JSON.parse(text)\n    } catch (ex) {\n        return text\n    }\n}\n","import React, {useContext, useState} from 'react'\nimport Card from '@material-ui/core/Card'\nimport CardHeader from '@material-ui/core/CardHeader'\nimport CardActions from '@material-ui/core/CardActions'\nimport CardContent from '@material-ui/core/CardContent'\nimport Button from '@material-ui/core/Button'\nimport Input from '@material-ui/core/Input'\nimport fetchJson from '../util/fetchJson'\nimport classnames from 'classnames'\nimport AuthContext from '../context/auth/AuthContext'\nimport IndicatorContext from '../context/indicators/IndicatorContext'\nimport {makeStyles} from '@material-ui/styles'\n\nfunction ReplyBox({onCloseReplyBox, parentId, className}) {\n    const classes = useStyles()\n    const {username, password} = useContext(AuthContext)\n    const {setLoading, showSnackbar} = useContext(IndicatorContext)\n    const [text, setText] = useState('')\n    const [posting, setPosting] = useState(false)\n\n    const handleSubmit = async () => {\n        try {\n            setLoading('async')\n            setPosting(true)\n            let response = await fetchJson('postComment', {method: 'POST', body: {username, password, parentId, text}})\n            if (response.result === 'success') {\n                onCloseReplyBox()\n            }\n        } catch (ex) {\n            console.log('Error while posting comment', ex)\n            showSnackbar('Error while posting. Please try again later.', {variant: 'error'})\n            setPosting(false)\n        } finally {\n            setLoading(false)\n        }\n    }\n\n    return (\n        <Card className={classnames(className, classes.card)}>\n            {parentId === 0 && <CardHeader title='New Thread'/>}\n            <CardContent>\n                <div className={classes.flexRow}>\n                    <Input\n                        multiline\n                        autoFocus\n                        disableUnderline\n                        rows={5}\n                        fullWidth\n                        className={classes.textarea}\n                        placeholder='Type something interesting...'\n                        name='replyBody'\n                        required\n                        disabled={posting}\n                        onChange={event => setText(event.target.value)}\n                    />\n                </div>\n            </CardContent>\n            <CardActions className={classes.actions}>\n                <Button\n                    color='primary'\n                    variant='outlined'\n                    disabled={posting || !text.length}\n                    onClick={handleSubmit}\n                >Post\n                </Button>\n                <Button\n                    variant='outlined'\n                    disabled={posting}\n                    onClick={onCloseReplyBox}\n                >Cancel\n                </Button>\n            </CardActions>\n        </Card>\n    )\n}\n\nconst useStyles = makeStyles({\n    card: {\n        backgroundColor: '#202224',\n        borderRadius: 0,\n        border: '1px solid #656565'\n    },\n    actions: {\n        margin: '-8px 0 8px 8px'\n    },\n    flexRow: {\n        display: 'flex',\n        flexDirection: 'row'\n    },\n    textarea: {\n        flex: 1,\n        backgroundColor: '#000',\n        padding: 4\n    }\n})\n\nexport default ReplyBox\n","import React, {useContext, useState} from 'react'\nimport IconButton from '@material-ui/core/IconButton'\nimport AddIcon from '../../node_modules/@material-ui/icons/Add'\nimport Tooltip from '@material-ui/core/Tooltip'\nimport Dialog from '@material-ui/core/Dialog'\nimport ReplyBox from '../replyBox/ReplyBox'\nimport AuthContext from '../context/auth/AuthContext'\nimport {makeStyles} from '@material-ui/styles'\n\nfunction NewThreadButton() {\n    const classes = useStyles()\n    const {isLoggedIn} = useContext(AuthContext)\n    const [open, setOpen] = useState(false)\n    if (!isLoggedIn) return null\n\n    return (\n        <React.Fragment>\n            <Tooltip disableFocusListener title='New Thread' enterDelay={350}>\n                <IconButton onClick={() => setOpen(true)}>\n                    <AddIcon/>\n                </IconButton>\n            </Tooltip>\n            <Dialog\n                open={open}\n                onClose={() => setOpen(false)}\n                classes={{paper: classes.dialogPaper}}\n            >\n                <ReplyBox\n                    parentId={0}\n                    onCloseReplyBox={() => setOpen(false)}\n                />\n            </Dialog>\n        </React.Fragment>\n    )\n}\n\nconst useStyles = makeStyles({\n    dialogPaper: {\n        width: '85vw'\n    }\n})\n\nexport default NewThreadButton\n","import React, {useContext, useEffect, useState} from 'react'\nimport IconButton from '@material-ui/core/IconButton'\nimport Tooltip from '@material-ui/core/Tooltip'\nimport MessageIcon from '@material-ui/icons/Message'\nimport Badge from '@material-ui/core/Badge'\nimport {makeStyles} from '@material-ui/styles'\nimport fetchJson from '../util/fetchJson'\nimport AuthContext from '../context/auth/AuthContext'\n\nfunction MessagesButton() {\n    const classes = useStyles()\n    const {isLoggedIn, username, password} = useContext(AuthContext)\n\n    const [totalMessagesCount, setTotalMessagesCount] = useState(0)\n    const [unreadMessagesCount, setUnreadMessagesCount] = useState(0)\n\n    const displayBadge = unreadMessagesCount > 0\n    const title = `( ${unreadMessagesCount} / ${totalMessagesCount} ) unread messages`\n\n    // update counts every 15 minutes\n    useEffect(() => {\n        const getCounts = async () => {\n            if (isLoggedIn) {\n                const options = {method: 'POST', body: {username, password}}\n                const {total, unread} = await fetchJson('getMessageCount', options)\n                setTotalMessagesCount(total)\n                setUnreadMessagesCount(unread)\n            }\n        }\n        \n        getCounts()\n\n        const id = setInterval(() => getCounts(), 15 * 60 * 1000)\n        return () => clearInterval(id)\n    }, [isLoggedIn, password, username])\n\n    if (!isLoggedIn) return null\n    return (\n        <Tooltip disableFocusListener title={title} enterDelay={350}>\n            <IconButton href='https://www.shacknews.com/messages' target='_blank'>\n                {\n                    displayBadge\n                        ? <Badge\n                            badgeContent={unreadMessagesCount}\n                            color='secondary'\n                            classes={{badge: classes.badge}}\n                        >\n                            <MessageIcon/>\n                        </Badge>\n                        : <MessageIcon/>\n                }\n            </IconButton>\n        </Tooltip>\n    )\n}\n\nconst useStyles = makeStyles({\n    badge: {\n        top: 12\n    }\n})\n\nexport default MessagesButton\n","import React from 'react'\n\nexport default React.createContext({})\n","import React, {useContext, useState} from 'react'\nimport IconButton from '@material-ui/core/IconButton'\nimport List from '@material-ui/core/List'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction'\nimport ListItemText from '@material-ui/core/ListItemText'\nimport Typography from '@material-ui/core/Typography'\nimport DeleteIcon from '@material-ui/icons/Delete'\nimport CheckIcon from '@material-ui/icons/Check'\nimport CloseIcon from '@material-ui/icons/Close'\nimport AddIcon from '@material-ui/icons/Add'\nimport TextField from '@material-ui/core/TextField'\nimport {makeStyles} from '@material-ui/styles'\nimport classnames from 'classnames'\nimport IndicatorContext from '../context/indicators/IndicatorContext'\n\nfunction EditableList({title, value, onChange}) {\n    const classes = useStyles()\n    const [editing, setEditing] = useState(false)\n    const [itemText, setItemText] = useState('')\n    const {showSnackbar} = useContext(IndicatorContext)\n\n    // TODO: This function doesn't make sense in a generic EditableList\n    const addItem = () => {\n        try {\n            if (itemText.length) {\n                const regex = new RegExp(itemText, 'gmi')\n                const newItem = {text: itemText, regex}\n                onChange && onChange(value.concat([newItem]))\n                setEditing(false)\n                setItemText('')\n            }\n        } catch (ex) {\n            showSnackbar('Invalid filter term.', {variant: 'error'})\n            console.error('Error processing new filter value', itemText, ex)\n        }\n    }\n    const removeItem = itemToRemove => onChange && onChange(value.filter(item => item !== itemToRemove))\n\n    return (\n        <div className={classes.container}>\n            <div className={classes.row}>\n                {\n                    editing ?\n                        <React.Fragment>\n                            <TextField\n                                placeholder={`Add new ${title.toLowerCase()}`}\n                                margin='none'\n                                autoFocus\n                                className={classes.fill}\n                                value={itemText}\n                                onKeyPress={event => event.key === 'Enter' && addItem(itemText)}\n                                onChange={event => setItemText(event.target.value)}\n                            />\n                            <IconButton onClick={() => addItem()}>\n                                <CheckIcon fontSize='small'/>\n                            </IconButton>\n                            <IconButton onClick={() => setEditing(false)}>\n                                <CloseIcon fontSize='small'/>\n                            </IconButton>\n                        </React.Fragment>\n                        :\n                        <React.Fragment>\n                            <Typography variant='subtitle1' className={classnames(classes.title, classes.fill)}>\n                                {title}s\n                            </Typography>\n\n                            <IconButton disableRipple onClick={() => setEditing(true)}>\n                                <AddIcon fontSize='small'/>\n                            </IconButton>\n                        </React.Fragment>\n                }\n            </div>\n            <List dense>\n                {\n                    value.length === 0 &&\n                    <ListItem dense>\n                        <ListItemText primary='List is empty.'/>\n                    </ListItem>\n                }\n                {value.length > 0 && value.map((item, key) =>\n                    <ListItem key={key} dense>\n                        <ListItemText primary={item.text}/>\n                        <ListItemSecondaryAction>\n                            <IconButton onClick={() => removeItem(item)}>\n                                <DeleteIcon fontSize='small'/>\n                            </IconButton>\n                        </ListItemSecondaryAction>\n                    </ListItem>\n                )}\n            </List>\n        </div>\n    )\n}\n\nconst useStyles = makeStyles({\n    row: {\n        display: 'flex',\n        flexDirection: 'row'\n    },\n    fill: {\n        display: 'flex',\n        flex: 1\n    },\n    container: {\n        marginTop: 12\n    },\n    title: {\n        marginTop: 6\n    }\n})\n\nexport default EditableList\n","import React from 'react'\nimport Checkbox from '@material-ui/core/Checkbox'\nimport FormControlLabel from '@material-ui/core/FormControlLabel'\nimport {makeStyles} from '@material-ui/styles'\n\nfunction FilterCheckbox({label, checked, onChange}) {\n    const classes = useStyles()\n    return (\n        <FormControlLabel\n            label={label}\n            className={classes.checkbox}\n            control={\n                <Checkbox\n                    checked={checked}\n                    onChange={onChange}\n                />\n            }\n        />\n    )\n}\n\nconst useStyles = makeStyles({\n    checkbox: {\n        marginBottom: -12\n    }\n})\n\nexport default FilterCheckbox\n","import React, {useContext, useState} from 'react'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport DialogActions from '@material-ui/core/DialogActions'\nimport Dialog from '@material-ui/core/Dialog'\nimport Button from '@material-ui/core/Button'\nimport FilterContext from '../context/filter/FilterContext'\nimport Typography from '@material-ui/core/Typography'\nimport EditableList from './EditableList'\nimport FilterCheckbox from './FilterCheckbox'\nimport {makeStyles} from '@material-ui/styles'\nimport IndicatorContext from '../context/indicators/IndicatorContext'\n\nfunction FilterDialog({open, onClose}) {\n    const classes = useStyles()\n    const {filterSettings, updateFilterSettings} = useContext(FilterContext)\n    const {setLoading} = useContext(IndicatorContext)\n    const [showCollapsed, setShowCollapsed] = useState(filterSettings.showCollapsed)\n    const [showFilteredTerms, setShowFilteredTerms] = useState(filterSettings.showFilteredTerms)\n    const [showFilteredUsers, setShowFilteredUsers] = useState(filterSettings.showFilteredUsers)\n    const [filteredTerms, setFilteredTerms] = useState(filterSettings.filteredTerms)\n    const [filteredUsers, setFilteredUsers] = useState(filterSettings.filteredUsers)\n\n    const handleSave = async () => {\n        try {\n            setLoading('sync')\n            await updateFilterSettings({showCollapsed, filteredTerms, filteredUsers})\n            onClose()\n        } finally {\n            setLoading(false)\n        }\n    }\n\n    return (\n        <Dialog open={open} onClose={onClose}>\n            <DialogTitle>Filter Settings</DialogTitle>\n            <DialogContent className={classes.content}>\n                <Typography variant='caption' color='textSecondary'>\n                    These settings adjust what posts display in the chatty. Filtered keywords will hide any\n                    posts that match. Filtered users will hide any posts or replies by that user. Terms support full\n                    regular expressions. Checking a checkbox will show posts even if they match that criteria.\n                </Typography>\n\n                <EditableList title='Term' value={filteredTerms} onChange={value => setFilteredTerms(value)}/>\n                <EditableList title='User' value={filteredUsers} onChange={value => setFilteredUsers(value)}/>\n\n                <div className={classes.checkboxes}>\n                    <FilterCheckbox\n                        label='Show Collapsed Threads'\n                        checked={showCollapsed}\n                        onChange={() => setShowCollapsed(!showCollapsed)}\n                    />\n                    <FilterCheckbox\n                        label='Show Filtered Terms'\n                        checked={showFilteredTerms}\n                        onChange={() => setShowFilteredTerms(!showFilteredTerms)}\n                    />\n                    <FilterCheckbox\n                        label='Show Filtered Users'\n                        checked={showFilteredUsers}\n                        onChange={() => setShowFilteredUsers(!showFilteredUsers)}\n                    />\n                </div>\n            </DialogContent>\n            <DialogActions>\n                <Button onClick={onClose}>Cancel</Button>\n                <Button onClick={handleSave}>Save</Button>\n            </DialogActions>\n        </Dialog>\n    )\n}\n\nconst useStyles = makeStyles({\n    content: {\n        display: 'flex',\n        flexDirection: 'column',\n        width: 300\n    },\n    checkboxes: {\n        marginTop: 12\n    }\n})\n\nexport default FilterDialog\n","import React, {useState} from 'react'\nimport IconButton from '@material-ui/core/IconButton/IconButton'\nimport FilterListIcon from '@material-ui/icons/FilterList'\nimport Tooltip from '@material-ui/core/Tooltip/Tooltip'\nimport FilterDialog from './FilterDialog'\n\nfunction FilterButton() {\n    const [open, setOpen] = useState(false)\n    const [rendered, setRendered] = useState(false)\n    return (\n        <React.Fragment>\n            <Tooltip disableFocusListener title='Filter Settings' enterDelay={350}>\n                <IconButton onClick={() => setOpen(true) || setRendered(true)}>\n                    <FilterListIcon/>\n                </IconButton>\n            </Tooltip>\n\n            {rendered && <FilterDialog open={open} onClose={() => setOpen(false)}/>}\n        </React.Fragment>\n    )\n}\n\nexport default FilterButton\n","import React, {useState} from 'react'\nimport AppBar from '@material-ui/core/AppBar'\nimport Toolbar from '@material-ui/core/Toolbar'\nimport IconButton from '@material-ui/core/IconButton'\nimport MenuIcon from '@material-ui/icons/Menu'\nimport MenuItem from '@material-ui/core/MenuItem'\nimport Typography from '@material-ui/core/Typography'\nimport UserMenu from '../userMenu/UserMenu'\nimport RefreshButton from './RefreshButton'\nimport NewThreadButton from './NewThreadButton'\nimport MessagesButton from './MessagesButton'\nimport FilterButton from '../filter/FilterButton'\nimport Drawer from '@material-ui/core/Drawer'\nimport {makeStyles} from '@material-ui/styles'\n\nfunction Nav() {\n    const classes = useStyles()\n    const [drawerOpen, setDrawerOpen] = useState(false)\n    const closeDrawer = () => setDrawerOpen(false)\n\n    return (\n        <React.Fragment>\n            <AppBar elevation={0}>\n                <Toolbar>\n                    <IconButton className={classes.menuButton} onClick={() => setDrawerOpen(!drawerOpen)}>\n                        <MenuIcon className={classes.white}/>\n                    </IconButton>\n\n                    <Typography variant=\"h5\" className={classes.title}>Chatty</Typography>\n\n                    <FilterButton/>\n                    <NewThreadButton/>\n                    <MessagesButton/>\n                    <RefreshButton/>\n                    <UserMenu/>\n                </Toolbar>\n            </AppBar>\n\n            <Drawer open={drawerOpen} onClose={closeDrawer} className={classes.drawer}>\n                <AppBar position=\"static\" color=\"primary\" className={classes.drawerAppBar}>\n                    <Toolbar>\n                        <Typography variant=\"h6\" className={classes.title}>Latest Chatty</Typography>\n                    </Toolbar>\n                </AppBar>\n\n                <a\n                    href=\"https://github.com/latestchatty/chatty\"\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                    className={classes.menuItem}>\n                    <MenuItem onClick={closeDrawer}>Contribute</MenuItem>\n                </a>\n                <a\n                    href=\"https://github.com/latestchatty/chatty/issues\"\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                    className={classes.menuItem}>\n                    <MenuItem onClick={closeDrawer}>Feedback</MenuItem>\n                </a>\n            </Drawer>\n        </React.Fragment>\n    )\n}\n\nconst useStyles = makeStyles({\n    white: {\n        color: '#fff'\n    },\n    title: {\n        color: '#fff',\n        flex: 1\n    },\n    menuButton: {\n        marginLeft: -15,\n        marginRight: 8\n    },\n    menuItem: {\n        textDecoration: 'none',\n        color: 'inherit'\n    }\n})\n\nexport default Nav\n","import React from 'react'\nimport {makeStyles} from '@material-ui/styles'\n\nfunction PostExpirationBar({date}) {\n    const classes = useStyles()\n    const now = (new Date().getTime())\n    const then = new Date(date).getTime()\n    const percent = Math.min((((now - then) / 3600000) / 18) * 100, 100)\n\n    let backgroundColor = 'red'\n    if (percent <= 25) {\n        backgroundColor = 'springgreen'\n    } else if (percent <= 50) {\n        backgroundColor = 'yellow'\n    } else if (percent <= 75) {\n        backgroundColor = 'orange'\n    }\n\n    return (\n        <div className={classes.wrapper}>\n            <div\n                className={classes.value}\n                style={{width: `${percent}%`, backgroundColor}}\n            />\n        </div>\n    )\n}\n\nconst useStyles = makeStyles({\n    wrapper: {\n        height: 8,\n        width: 48,\n        margin: 7,\n        background:\n            `rgb(221, 221, 221) -webkit-gradient(\n                linear,\n                0% 0%,\n                0% 100%,\n                from(rgb(170, 170, 170)),\n                color-stop(0.4, rgb(204, 204, 204)),\n                color-stop(0.6, rgb(204, 204, 204)),\n                to(rgb(238, 238, 238))\n            )`\n    },\n    value: {\n        height: 8,\n        backgroundImage:\n            `-webkit-gradient(\n                linear,\n                0 100%,\n                100% 0,\n                color-stop(0.25, rgba(255, 255, 255, 0.4)),\n                color-stop(0.25, transparent),\n                color-stop(0.5, transparent),\n                color-stop(0.5, rgba(255, 255, 255, 0.4)),\n                color-stop(0.75, rgba(255, 255, 255, 0.4)),\n                color-stop(0.75, transparent),\n                to(transparent)\n            )`,\n        backgroundSize: '25px 25px',\n        boxShadow: 'rgba(255, 255, 255, 0.298039) 0 2px 4px inset, rgba(0, 0, 0, 0.4) 0 -2px 3px inset'\n    }\n})\n\nexport default PostExpirationBar\n","import React from 'react'\nimport Tooltip from '@material-ui/core/Tooltip'\nimport format from 'date-fns/format'\nimport formatDistanceToNow from 'date-fns/formatDistanceToNow'\nimport parseISO from 'date-fns/parseISO'\nimport {makeStyles} from '@material-ui/styles'\n\nfunction PostDate({date}) {\n    const classes = useStyles()\n    const parsed = parseISO(date)\n    return (\n        <Tooltip disableFocusListener title={format(parsed, 'MMM dd, yyyy h:mma')} enterDelay={350}>\n            <div className={classes.date}>{formatDistanceToNow(parsed)} ago</div>\n        </Tooltip>\n    )\n}\n\nconst useStyles = makeStyles({\n    date: {\n        fontSize: 10,\n        color: '#888',\n        paddingTop: 3,\n        marginRight: 3\n    }\n})\n\nexport default PostDate\n","import React, {useContext, useMemo} from 'react'\nimport classnames from 'classnames'\nimport AuthContext from '../context/auth/AuthContext'\nimport {makeStyles} from '@material-ui/styles'\n\nfunction PostAuthor({post = {}, thread = {}}) {\n    const classes = useStyles()\n    const {username} = useContext(AuthContext)\n    const {author = ''} = post\n\n    const isSameUser = (one = '', two = '') => {\n        const left = one.toLowerCase().replace(/\\s/g, '')\n        const right = two.toLowerCase().replace(/\\s/g, '')\n        return left === right\n    }\n\n    const userClass = useMemo(() => {\n        if (username && isSameUser(author, username)) return 'self'\n        else if (thread.id !== post.id && isSameUser(thread.author, author)) return 'op'\n        else if (employees.find(employee => isSameUser(employee, author))) return 'employee'\n        else if (mods.find(mod => isSameUser(mod, author))) return 'mod'\n        return 'normal'\n    }, [username, author, thread.id, post.id, thread.author])\n\n    // Don't let the browser line break in the middle of author name\n    const nonBreakingAuthor = useMemo(() => author.replace(/\\s/g, String.fromCharCode(160)), [author])\n\n    return (\n        <span className={classnames(classes.user, classes[userClass])}>\n            {nonBreakingAuthor}\n        </span>\n    )\n}\n\nconst employees = [\n    'themanwiththebriefcase',\n    'shacknews'\n]\nconst mods = []\n\nconst useStyles = makeStyles({\n    user: {\n        fontSize: 14,\n        fontWeight: 'bold',\n        cursor: 'pointer',\n        '&:hover': {\n            textDecoration: 'underline'\n        }\n    },\n    normal: {\n        color: '#f3e7b5'\n    },\n    self: {\n        color: '#6cf'\n    },\n    op: {\n        color: '#6aff94'\n    },\n    mod: {\n        color: '#d20000'\n    },\n    employee: {\n        color: '#9370db'\n    }\n})\n\nexport default PostAuthor\n","export default ['lol', 'inf', 'unf', 'wtf']\n","import React, {useMemo} from 'react'\nimport Chip from '@material-ui/core/Chip'\nimport classnames from 'classnames'\nimport supportedTags from './supportedTags'\nimport {makeStyles} from '@material-ui/styles'\n\nfunction Tags({tags = [], variant}) {\n    const classes = useStyles()\n    const fixedTags = useMemo(() => {\n        const validTags = tags.filter(tag => supportedTags.includes(tag.tag))\n        const miscTagCount = tags.filter(tag => !supportedTags.includes(tag.tag))\n            .reduce((acc, tag) => acc + tag.count, 0)\n        return [\n            ...validTags,\n            {tag: 'tag', count: miscTagCount}\n        ]\n    }, [tags])\n\n    return (\n        <div className={variant === 'post' ? classes.containerPost : classes.containerOneline}>\n            {fixedTags.map(tag => {\n                if (tag.count < 1) return null\n                else if (variant === 'post') {\n                    return (\n                        <Chip\n                            key={tag.tag}\n                            className={classnames(classes.chip, classes[tag.tag], classes[`${tag.tag}Border`])}\n                            label={`${tag.count} ${tag.tag}`}\n                            variant='outlined'\n                        />\n                    )\n                } else if (variant === 'oneline') {\n                    return (\n                        <span key={tag.tag} className={classnames(classes.nonChip, classes[tag.tag])}>\n                            {`${tag.count} ${tag.tag}`}\n                        </span>\n                    )\n                }\n                return null\n            })}\n        </div>\n    )\n}\n\nconst useStyles = makeStyles({\n    containerPost: {\n        marginLeft: 12\n    },\n    containerOneline: {\n        marginLeft: 4,\n        whiteSpace: 'nowrap'\n    },\n    chip: {\n        height: 16,\n        marginTop: 2,\n        marginRight: 6,\n        fontSize: 10\n    },\n    nonChip: {\n        marginRight: 4,\n        fontSize: 9\n    },\n    lolBorder: {\n        border: '1px solid #f80'\n    },\n    infBorder: {\n        border: '1px solid #09c'\n    },\n    unfBorder: {\n        border: '1px solid #f00'\n    },\n    wtfBorder: {\n        border: '1px solid #c000c0'\n    },\n    tagBorder: {\n        border: '1px solid #bbaf57'\n    },\n    lol: {\n        color: '#f80'\n    },\n    inf: {\n        color: '#09c'\n    },\n    unf: {\n        color: '#f00'\n    },\n    wtf: {\n        color: '#c000c0'\n    },\n    tag: {\n        color: '#bbaf57'\n    }\n})\n\nexport default Tags\n","import React, {useContext, useState} from 'react'\nimport Tooltip from '@material-ui/core/Tooltip'\nimport LabelIcon from '@material-ui/icons/Label'\nimport Menu from '@material-ui/core/Menu'\nimport MenuItem from '@material-ui/core/MenuItem'\nimport querystring from 'querystring'\nimport AuthContext from '../context/auth/AuthContext'\nimport supportedTags from './supportedTags'\nimport IndicatorContext from '../context/indicators/IndicatorContext'\n\nfunction TagButton({className, postId}) {\n    const {isLoggedIn, username} = useContext(AuthContext)\n    const {setLoading, showSnackbar} = useContext(IndicatorContext)\n    const [anchorEl, setAnchorEl] = useState(null)\n\n    const tags = supportedTags.map(tag => tag.toUpperCase())\n\n    const handleTag = async tag => {\n        try {\n            setLoading('async')\n            setAnchorEl(null)\n\n            let text = await tagPost(username, postId, tag)\n            if (text.includes('already tagged')) {\n                text = await tagPost(username, postId, tag, 'untag')\n            }\n            if (!text.match(/^ok /)) {\n                console.warn('Error tagging post', text)\n            }\n        } catch (err) {\n            console.error('Exception while tagging post', err)\n            showSnackbar('Error while tagging post. Please try again later.', {variant: 'error'})\n        } finally {\n            setLoading(false)\n        }\n    }\n\n    const tagPost = async (who, what, tag, action) => {\n        const base = 'https://lol.lmnopc.com/report.php'\n        const params = {who, what, tag, version: -1}\n        if (action) params.action = action\n        const response = await fetch(`${base}?${querystring.stringify(params)}`, {method: 'POST'})\n        return response.text()\n    }\n\n    if (!isLoggedIn) return null\n    return (\n        <React.Fragment>\n            <Tooltip disableFocusListener title='Tag Post' enterDelay={350}>\n                <LabelIcon className={className} onClick={event => setAnchorEl(event.target)}/>\n            </Tooltip>\n\n            {\n                anchorEl && <Menu\n                    keepMounted\n                    open={!!anchorEl}\n                    anchorEl={anchorEl}\n                    onClose={() => setAnchorEl(null)}\n                >\n                    {tags.map(tag => <MenuItem key={tag} onClick={() => handleTag(tag)}>{tag}</MenuItem>)}\n                </Menu>\n            }\n        </React.Fragment>\n    )\n}\n\nexport default TagButton\n","import React, {useMemo} from 'react'\n\nfunction PostBody({post}) {\n    const html = useMemo(() => {\n        let fixed = post.body\n\n        if (post.author === 'Shacknews') {\n            fixed = post.body.replace('href=\"/', 'href=\"https://www.shacknews.com/')\n        }\n\n        // TODO: search for embeddable urls here\n\n        return {__html: fixed}\n    }, [post.body, post.author])\n\n    return (\n        <span dangerouslySetInnerHTML={html}/>\n    )\n}\n\nexport default PostBody\n","import React, {useContext, useEffect, useMemo, useRef} from 'react'\nimport Card from '@material-ui/core/Card'\nimport CardActions from '@material-ui/core/CardActions'\nimport CardContent from '@material-ui/core/CardContent'\nimport Tooltip from '@material-ui/core/Tooltip'\nimport CloseIcon from '@material-ui/icons/Close'\nimport StarIcon from '@material-ui/icons/Star'\nimport StarBorderIcon from '@material-ui/icons/StarBorder'\nimport ExitToAppIcon from '@material-ui/icons/ExitToApp'\nimport ReplyIcon from '@material-ui/icons/Reply'\nimport PostExpirationBar from './PostExpirationBar'\nimport PostDate from './PostDate'\nimport PostAuthor from './PostAuthor'\nimport classnames from 'classnames'\nimport ReplyBox from '../replyBox/ReplyBox'\nimport Tags from './Tags'\nimport TagButton from './TagButton'\nimport AuthContext from '../context/auth/AuthContext'\nimport FilterContext from '../context/filter/FilterContext'\nimport {makeStyles} from '@material-ui/styles'\nimport PostBody from './PostBody'\n\nfunction Post({post, thread, onCollapse, onPinned, replyBoxOpenForId, onOpenReplyBox, onCloseReplyBox}) {\n    const classes = useStyles()\n    const domElement = useRef(null)\n    const {isLoggedIn} = useContext(AuthContext)\n    const {isPostVisible} = useContext(FilterContext)\n\n    const tagClass = useMemo(() => {\n        if (post.category === 'nuked') {\n            return null\n        } else if (post.category === 'nws') {\n            return 'tagNws'\n        } else if (post.category === 'informative') {\n            return 'tagInformative'\n        } else if (/shacknews/i.test(post.author)) {\n            return 'tagFrontpage'\n        }\n        return null\n    }, [post.category, post.author])\n\n    const isReply = post.parentId > 0\n    const replyBorder = isReply ? 'replyBorder' : null\n\n    const handleReplyClick = () => onOpenReplyBox(post.id)\n\n    // Scroll into view when first visible\n    useEffect(() => {\n        if (isReply) {\n            const rect = domElement.current.getBoundingClientRect()\n            const viewHeight = Math.max(document.documentElement.clientHeight, window.innerHeight)\n            const above = rect.bottom < 0\n            const below = rect.top - viewHeight >= 0\n            if (above) {\n                window.scrollTo({\n                    left: 0,\n                    top: domElement.current.offsetTop - 75,\n                    behavior: 'smooth'\n                })\n            } else if (below) {\n                window.scrollTo({\n                    left: 0,\n                    top: domElement.current.offsetTop - viewHeight + rect.height + 24,\n                    behavior: 'smooth'\n                })\n            }\n        }\n    }, [isReply])\n\n    const visible = useMemo(() => isPostVisible(thread, post), [isPostVisible, post, thread])\n    if (!visible) return null\n    return (\n        <React.Fragment>\n            <div ref={domElement}>\n                <Card className={classnames(classes.card, classes[tagClass], classes[replyBorder])}>\n                    <div className={classes.header}>\n                        <PostAuthor post={post} thread={thread}/>\n\n                        <Tags tags={post.lols} variant='post'/>\n\n                        <span className={classes.flex}/>\n\n                        <PostDate date={post.date}/>\n\n                        {post.parentId === 0 && <PostExpirationBar date={post.date}/>}\n                    </div>\n\n                    <CardContent className={classnames('postbody', classes.content)}>\n                        <PostBody post={post}/>\n                    </CardContent>\n\n                    <CardActions className={classes.actions} disableSpacing>\n                        <Tooltip\n                            disableFocusListener\n                            title={post.markType === 'collapsed' ? 'Uncollapse' : 'Collapse'}\n                            enterDelay={350}\n                        >\n                            <CloseIcon\n                                className={\n                                    classnames(classes.toolbarButton, post.markType === 'collapsed' ? classes.collapsed : null)\n                                }\n                                onClick={onCollapse}\n                            />\n                        </Tooltip>\n\n                        {\n                            isLoggedIn &&\n                            <Tooltip disableFocusListener title='Reply' enterDelay={350}>\n                                <ReplyIcon className={classes.toolbarButton} onClick={handleReplyClick}/>\n                            </Tooltip>\n                        }\n\n                        {\n                            isLoggedIn && post.parentId === 0 &&\n                            <React.Fragment>\n                                {\n                                    post.markType === 'pinned' &&\n                                    <Tooltip disableFocusListener title='Unpin Thread' enterDelay={350}>\n                                        <StarIcon\n                                            className={classnames(classes.toolbarButton, classes.pinned)}\n                                            onClick={onPinned}\n                                        />\n                                    </Tooltip>\n                                }\n                                {\n                                    post.markType !== 'pinned' &&\n                                    <Tooltip disableFocusListener title='Pin Thread' enterDelay={350}>\n                                        <StarBorderIcon className={classes.toolbarButton} onClick={onPinned}/>\n                                    </Tooltip>\n                                }\n                            </React.Fragment>\n                        }\n\n                        <TagButton postId={post.id} className={classes.toolbarButton}/>\n\n                        <Tooltip disableFocusListener title='View Post @ Shacknews.com' enterDelay={350}>\n                            <a\n                                className={classes.toolbarButton}\n                                target='_blank'\n                                rel=\"noopener noreferrer\"\n                                href={`http://www.shacknews.com/chatty?id=${post.id}#item_${post.id}`}\n                            >\n                                <ExitToAppIcon className={classes.toolbarButton}/>\n                            </a>\n                        </Tooltip>\n                    </CardActions>\n                </Card>\n            </div>\n            {\n                replyBoxOpenForId === post.id &&\n                <ReplyBox parentId={post.id} onCloseReplyBox={onCloseReplyBox} className={classes.replyBox}/>\n            }\n        </React.Fragment>\n    )\n}\n\nconst useStyles = makeStyles({\n    card: {\n        backgroundColor: '#202224',\n        borderRadius: 0,\n        marginBottom: 3\n    },\n    replyBorder: {\n        border: '1px solid #656565'\n    },\n    replyBox: {\n        marginTop: -3\n    },\n    tagNws: {\n        borderLeft: '3px solid red !important'\n    },\n    tagInformative: {\n        borderLeft: '3px solid #00bff3 !important'\n    },\n    tagFrontpage: {\n        borderLeft: '3px solid mediumpurple !important'\n    },\n    content: {\n        maxWidth: 'calc(100vw - 32)',\n        color: 'lightgray',\n        fontSize: 13,\n        padding: '8px 16px'\n    },\n    header: {\n        backgroundColor: '#373a3c',\n        padding: '3px 3px 3px 16px',\n        display: 'flex',\n        flexDirection: 'row'\n    },\n    actions: {\n        height: 34,\n        padding: '0 8px 0 8px'\n    },\n    flex: {\n        flex: 1\n    },\n    toolbarButton: {\n        width: 18,\n        height: 18,\n        cursor: 'pointer',\n        color: '#fff',\n        marginRight: 6\n    },\n    collapsed: {\n        color: '#f00 !important'\n    },\n    pinned: {\n        color: '#fcbf20 !important'\n    }\n})\n\nexport default Post\n","export const cleanAllStyles = body => body.replace(/(<[^>]+>)/gm, '')\nexport const cleanMostStyles = body => body.replace(/(<(?!span)(?!\\/span)[^>]+>| tabindex=\"1\")/gm, ' ')\n\nexport const getSnippet = body => {\n    const input = cleanMostStyles(body)\n    const maxLength = 106\n\n    let i = 0\n    let len = 0\n    let tag = false\n    let char = false\n    while (i < input.length && len < maxLength) {\n        if (input[i] === '<') {\n            tag = true\n        } else if (input[i] === '>') {\n            tag = false\n        } else if (input[i] === '&') {\n            char = true\n        } else if (input[i] === '' && char) {\n            char = false\n            len++\n        } else if (!tag) {\n            len++\n        }\n\n        i++\n    }\n\n    let output = input.slice(0, i).trim()\n    if (i < input.length || !output) {\n        output += '...'\n    }\n\n    return output\n}\n","import React, {useMemo} from 'react'\nimport PostAuthor from './PostAuthor'\nimport classnames from 'classnames'\nimport Tags from './Tags'\nimport {makeStyles} from '@material-ui/styles'\nimport {getSnippet} from '../util/bodyUtils'\n\nfunction OneLine({post, thread, onExpandReply}) {\n    const classes = useStyles()\n\n    const lineClass = `oneline${post.recentReplyNumber || 9}`\n    const oneline = useMemo(() => getSnippet(post.body), [post.body])\n\n    return (\n        <div className={classes.container}>\n            <span\n                className={classnames(classes.oneline, classes[lineClass])}\n                dangerouslySetInnerHTML={{__html: oneline}}\n                onClick={() => onExpandReply(post.id)}\n            />\n            <Tags tags={post.lols} variant='oneline'/>\n            <PostAuthor post={post} thread={thread}/>\n        </div>\n    )\n}\n\nconst useStyles = makeStyles({\n    container: {\n        display: 'flex',\n        flexDirection: 'row'\n    },\n    separator: {\n        padding: '0 3px',\n        fontSize: 11,\n        color: '#fff'\n    },\n    oneline: {\n        whiteSpace: 'nowrap',\n        overflow: 'hidden',\n        textOverflow: 'ellipsis',\n        '&:hover': {\n            color: '#fff',\n            backgroundColor: '#233548',\n            cursor: 'pointer'\n        }\n    },\n    oneline10: {\n        color: '#777'\n    },\n    oneline9: {\n        color: '#888'\n    },\n    oneline8: {\n        color: '#999'\n    },\n    oneline7: {\n        color: '#aaa'\n    },\n    oneline6: {\n        color: '#bbb'\n    },\n    oneline5: {\n        color: '#ccc'\n    },\n    oneline4: {\n        color: '#ddd'\n    },\n    oneline3: {\n        color: '#eee'\n    },\n    oneline2: {\n        color: '#fff'\n    },\n    oneline1: {\n        color: '#eee',\n        fontWeight: 'bold'\n    }\n})\n\nexport default OneLine\n","import React, {useContext} from 'react'\nimport Post from './Post'\nimport OneLine from './OneLine'\nimport FilterContext from '../context/filter/FilterContext'\nimport classnames from 'classnames'\n\nfunction Comments({className, thread = {}, parent = thread, onCollapseReply, onExpandReply, onOpenReplyBox, expandedReplyId, replyBoxOpenForId, onCloseReplyBox}) {\n    const {isPostVisible} = useContext(FilterContext)\n    return (\n        <ul className={classnames('comments', className)}>\n            {\n                thread.posts\n                    .filter(post => post.parentId === parent.id)\n                    .filter(post => isPostVisible(thread, post))\n                    .map(post =>\n                        <li key={post.id}>\n                            {\n                                expandedReplyId === post.id\n                                    ? <Post\n                                        post={post}\n                                        thread={thread}\n                                        onCollapse={onCollapseReply}\n                                        replyBoxOpenForId={replyBoxOpenForId}\n                                        onOpenReplyBox={onOpenReplyBox}\n                                        onCloseReplyBox={onCloseReplyBox}\n                                    />\n                                    : <OneLine\n                                        post={post}\n                                        thread={thread}\n                                        onExpandReply={onExpandReply}\n                                    />\n                            }\n                            <Comments\n                                thread={thread}\n                                parent={post}\n                                expandedReplyId={expandedReplyId}\n                                replyBoxOpenForId={replyBoxOpenForId}\n                                onExpandReply={onExpandReply}\n                                onCollapseReply={onCollapseReply}\n                                onOpenReplyBox={onOpenReplyBox}\n                                onCloseReplyBox={onCloseReplyBox}\n                            />\n                        </li>\n                    )\n            }\n        </ul>\n    )\n}\n\nexport default Comments\n","import React, {useContext, useMemo, useState} from 'react'\nimport Post from './Post'\nimport Comments from './Comments'\nimport FilterContext from '../context/filter/FilterContext'\nimport {makeStyles} from '@material-ui/styles'\nimport fetchJson from '../util/fetchJson'\nimport AuthContext from '../context/auth/AuthContext'\n\nfunction Thread({thread: rawThread}) {\n    const classes = useStyles()\n    const [expandedReplyId, setExpandedReplyId] = useState(null)\n    const [replyBoxOpenForId, setReplyBoxOpenForId] = useState(null)\n    const [truncated, setTruncated] = useState(rawThread.posts.length > 20)\n    const [markType, setMarkType] = useState(rawThread.markType)\n    const {username, isLoggedIn} = useContext(AuthContext)\n    const {isPostVisible} = useContext(FilterContext)\n    const thread = useMemo(() => {\n        const posts = rawThread.posts ? rawThread.posts.sort((a, b) => a.id - b.id) : []\n\n        // oneline highlights\n        posts.slice(-10)\n            .reverse()\n            .forEach((post, index) => post.recentReplyNumber = index + 1)\n\n        const [post] = posts\n        return {\n            ...rawThread,\n            ...post,\n            id: +rawThread.threadId,\n            posts: posts,\n            markType\n        }\n    }, [rawThread, markType])\n\n    const markThread = async (postId, type) => {\n        setMarkType(type)\n        if (isLoggedIn) {\n            try {\n                await fetchJson('clientData/markPost', {\n                    method: 'POST',\n                    body: {username, postId, type}\n                })\n            } catch (ex) {\n                console.error('Error marking post.', ex)\n            }\n        }\n    }\n\n    const handleExpandReply = expandedReplyId => {\n        setExpandedReplyId(expandedReplyId)\n        setReplyBoxOpenForId(null)\n        setTruncated(false)\n    }\n    const handleCollapseReply = () => {\n        setExpandedReplyId(null)\n        setReplyBoxOpenForId(null)\n    }\n    const handleOpenReplyBox = id => setReplyBoxOpenForId(id)\n    const handleCloseReplyBox = () => setReplyBoxOpenForId(null)\n\n    const handleCollapse = () => markThread(thread.threadId, thread.markType === 'unmarked' ? 'collapsed' : 'unmarked')\n    const togglePinned = () => markThread(thread.threadId, thread.markType === 'unmarked' ? 'pinned' : 'unmarked')\n\n    const visible = useMemo(() => isPostVisible(thread), [isPostVisible, thread])\n    if (!visible) return null\n    return (\n        <div className={classes.thread}>\n            <Post\n                post={thread}\n                thread={thread}\n                replyBoxOpenForId={replyBoxOpenForId}\n                onCollapse={handleCollapse}\n                onOpenReplyBox={handleOpenReplyBox}\n                onCloseReplyBox={handleCloseReplyBox}\n                onPinned={togglePinned}\n            />\n\n            {\n                truncated &&\n                <div className={classes.truncatedMessage} onClick={() => setTruncated(false)}>\n                    Thread truncated. Click to see all&nbsp;\n                    <span className={classes.replyCount}>{thread.posts.length - 1}</span>\n                    &nbsp;replies.\n                </div>\n            }\n\n            <div className={truncated ? classes.truncatedContainer : null}>\n                <Comments\n                    className={truncated ? classes.truncatedComments : null}\n                    thread={thread}\n                    expandedReplyId={expandedReplyId}\n                    replyBoxOpenForId={replyBoxOpenForId}\n                    onExpandReply={handleExpandReply}\n                    onCollapseReply={handleCollapseReply}\n                    onOpenReplyBox={handleOpenReplyBox}\n                    onCloseReplyBox={handleCloseReplyBox}\n                />\n            </div>\n        </div>\n    )\n}\n\nconst useStyles = makeStyles({\n    thread: {\n        marginBottom: 15\n    },\n    truncatedMessage: {\n        color: '#fff',\n        fontWeight: 'bold',\n        borderTop: '1px solid #656565',\n        borderBottom: '1px dotted #fff',\n        backgroundColor: '#181818',\n        cursor: 'pointer',\n        marginTop: -3,\n        '&:hover': {\n            backgroundColor: '#282828'\n        }\n    },\n    replyCount: {\n        color: '#00bff3'\n    },\n    truncatedContainer: {\n        height: 300,\n        overflow: 'hidden',\n        position: 'relative'\n    },\n    truncatedComments: {\n        position: 'absolute !important',\n        bottom: 0\n    }\n})\n\nexport default React.memo(Thread)\n","import React, {useContext} from 'react'\nimport Thread from '../thread/Thread'\nimport ChattyContext from '../context/chatty/ChattyContext'\nimport {makeStyles} from '@material-ui/styles'\n\nfunction Chatty() {\n    const classes = useStyles()\n    const {threads} = useContext(ChattyContext)\n    return (\n        <div className={classes.chatty}>\n            {threads.map(thread => <Thread key={thread.threadId} thread={thread}/>)}\n        </div>\n    )\n}\n\nconst useStyles = makeStyles({\n    chatty: {\n        margin: '72px 8px 8px 8px',\n        font: '12px/1.5 arial, helvetica, clean, sans-serif'\n    }\n})\n\nexport default Chatty\n","import React from 'react'\nimport {Route, Switch} from 'react-router-dom'\nimport Nav from '../nav/Nav'\nimport Chatty from '../chatty/Chatty'\n\nfunction App() {\n    return (\n        <React.Fragment>\n            <Nav/>\n            <Switch>\n                <Route path=\"/chatty\" component={Chatty}/>\n\n                <Route component={Chatty}/>\n            </Switch>\n        </React.Fragment>\n    )\n}\n\nexport default App\n","import React, {useCallback, useContext, useMemo, useState} from 'react'\nimport AuthContext from './AuthContext'\nimport fetchJson from '../../util/fetchJson'\nimport IndicatorContext from '../indicators/IndicatorContext'\n\nfunction AuthProvider({children}) {\n    const {setLoading, showSnackbar} = useContext(IndicatorContext)\n    const [credentials, setCredentials] = useState(() => {\n        try {\n            const storageValue = localStorage.getItem('auth') || '{}'\n            const {username, password} = JSON.parse(storageValue) || {}\n            return {username, password}\n        } catch (ex) {\n            console.log('Invalid storage value: auth', ex)\n            localStorage.removeItem('auth')\n            return {username: null, password: null}\n        }\n    })\n\n    const login = useCallback(async (username, password) => {\n        try {\n            setLoading('async')\n\n            const result = await fetchJson(`verifyCredentials`, {method: 'POST', body: {username, password}})\n\n            if (result.isValid) {\n                localStorage.setItem('auth', JSON.stringify({username, password}))\n                setCredentials({username, password})\n            } else {\n                console.log('Invalid login credentials.')\n                showSnackbar('Invalid username/password. Please check them and try again', {variant: 'error'})\n            }\n        } catch (ex) {\n            console.log('Error while logging in', ex)\n            showSnackbar('Error while logging in. Please try again later.', {variant: 'error'})\n        } finally {\n            setLoading(false)\n        }\n    }, [setLoading, showSnackbar])\n\n    const logout = useCallback(() => {\n        localStorage.removeItem('auth')\n        setCredentials({username: null, password: null})\n    }, [])\n\n    const isLoggedIn = credentials.username && credentials.password\n    const contextValue = useMemo(() => ({\n        ...credentials, \n        isLoggedIn, \n        login, \n        logout\n    }), [credentials, isLoggedIn, login, logout])\n\n    return (\n        <AuthContext.Provider value={contextValue}>\n            {children}\n        </AuthContext.Provider>\n    )\n}\n\nexport default AuthProvider\n","import React, {useCallback, useContext, useEffect, useMemo, useState} from 'react'\nimport ChattyContext from './ChattyContext'\nimport fetchJson from '../../util/fetchJson'\nimport AuthContext from '../auth/AuthContext'\nimport IndicatorContext from '../indicators/IndicatorContext'\nimport subHours from 'date-fns/subHours'\nimport isBefore from 'date-fns/isBefore'\nimport parseISO from 'date-fns/parseISO'\n\nfunction ChattyProvider({children}) {\n    const {isLoggedIn, username} = useContext(AuthContext)\n    const {setLoading, showSnackbar} = useContext(IndicatorContext)\n    const [chatty, setChatty] = useState({threads: [], newThreads: []})\n    const [lastEventId, setLastEventId] = useState(0)\n\n    const getMarkedPosts = useCallback(async () => {\n        if (isLoggedIn) {\n            const {markedPosts} = await fetchJson(`clientData/getMarkedPosts?username=${encodeURIComponent(username)}`)\n            return markedPosts\n        }\n        return []\n    }, [isLoggedIn, username])\n\n    const updateThreads = useCallback(async (freshThreads = false, freshMarkedPosts = false, includeNewThreads = false) => {\n        // fresh chatty load from server\n        let {threads: nextThreads} = freshThreads ? await getChatty() : {}\n\n        // process marked posts if needed\n        let markedPosts\n        if (freshMarkedPosts) markedPosts = await getMarkedPosts(freshMarkedPosts)\n\n        // compile new thread state\n        nextThreads = nextThreads || chatty.threads\n\n        // only add in new threads when needed\n        nextThreads = includeNewThreads ? chatty.newThreads.concat(nextThreads) : nextThreads\n        let nextNewThreads = includeNewThreads ? [] : chatty.newThreads\n\n        // if we're loading marked posts, process the data\n        if (markedPosts) {\n            const markedPostsById = markedPosts\n                .reduce((acc, post) => ({\n                    ...acc,\n                    [post.id]: post.type\n                }), {})\n\n            // update post markings\n            nextThreads = nextThreads\n                .map(thread => ({\n                    ...thread,\n                    markType: markedPostsById[thread.threadId] || 'unmarked'\n                }))\n        }\n\n        // order by recent activity\n        let maxPostIdByThread = nextThreads\n            .reduce((acc, thread) => {\n                acc[thread.threadId] = thread.posts.reduce((acc, post) => Math.max(post.id, acc), 0)\n                return acc\n            }, {})\n\n        // remove expired threads\n        const expireDate = subHours(Date.now(), 18)\n        nextThreads = nextThreads.filter(thread => {\n            const threadId = +thread.threadId\n            const post = thread.posts.find(post => post.id === threadId)\n            const parsed = parseISO(post.date)\n            return isBefore(expireDate, parsed)\n        })\n\n        // sort by activity, pinned first\n        nextThreads = nextThreads\n            .sort((a, b) => maxPostIdByThread[b.threadId] - maxPostIdByThread[a.threadId])\n            .sort((a, b) => a.markType === 'pinned' ? -1 : (b.markType === 'pinned' ? 1 : 0))\n\n        // update state to trigger render\n        setChatty({\n            threads: nextThreads,\n            newThreads: nextNewThreads\n        })\n\n        // clean up any old posts after loading, doesn't impact state\n        if (markedPosts) {\n            let ids = markedPosts\n                .filter(post => !maxPostIdByThread[post.id])\n                .map(({id}) => id)\n            if (ids.length) {\n                try {\n                    await fetchJson('clientData/markPost', {\n                        method: 'POST',\n                        body: {username, postId: ids.join(','), type: 'unmarked'}\n                    })\n                } catch (ex) {\n                    console.error('Error unmarking old posts.', ex)\n                }\n            }\n        }\n    }, [chatty.newThreads, chatty.threads, getMarkedPosts, username])\n\n    const getChatty = async threadCount => {\n        return await fetchJson(`getChatty${threadCount > 0 ? `?count=${threadCount}` : ''}`)\n    }\n\n    const handleEvent = (event = {}, current) => {\n        const {eventType, eventData} = event\n\n        if (eventType === 'newPost') {\n            const {post} = eventData\n            if (post.parentId) {\n                const threadId = `${post.threadId}`\n                const addReply = thread => {\n                    if (thread.threadId === threadId) {\n                        return {\n                            ...thread,\n                            posts: [\n                                ...thread.posts,\n                                post\n                            ]\n                        }\n                    }\n                    return thread\n                }\n\n                return {\n                    threads: current.threads.map(addReply),\n                    newThreads: current.newThreads.map(addReply)\n                }\n            } else {\n                return {\n                    threads: current.threads,\n                    newThreads: [\n                        ...current.newThreads,\n                        {\n                            threadId: `${post.id}`,\n                            posts: [\n                                post\n                            ]\n                        }\n                    ]\n                }\n            }\n        } else if (eventType === 'categoryChange') {\n            const {postId, category} = eventData\n            const updateCategory = thread => {\n                const threadContainsUpdate = thread.posts.find(post => post.id === postId)\n                if (threadContainsUpdate) {\n                    const posts = thread.posts\n                        .map(post => {\n                            if (post.id === postId) {\n                                return {...post, category}\n                            }\n                            return post\n                        })\n                    return {...thread, posts}\n                }\n                return thread\n            }\n\n            return {\n                threads: current.threads.map(updateCategory),\n                newThreads: current.newThreads.map(updateCategory)\n            }\n        } else if (eventType === 'lolCountsUpdate') {\n            const {updates} = eventData\n            const updatedPostsById = updates\n                .reduce(((acc, {postId, tag, count}) => ({\n                    ...acc,\n                    [postId]: {tag, count}\n                })), {})\n            const updateTags = thread => {\n                const threadContainsUpdate = thread.posts.find(post => updatedPostsById[post.id])\n                if (threadContainsUpdate) {\n                    const posts = thread.posts\n                        .map(post => {\n                            const updated = updatedPostsById[post.id]\n                            if (updated) {\n                                const lols = (post.lols || [])\n                                    .filter(tag => tag.tag !== updated.tag)\n                                    .concat([updated])\n                                return {...post, lols}\n                            }\n                            return post\n                        })\n                    return {...thread, posts}\n                }\n                return thread\n            }\n\n            return {\n                threads: current.threads.map(updateTags),\n                newThreads: current.newThreads.map(updateTags)\n            }\n        } else {\n            console.debug('Unhandled event type:', event)\n        }\n    }\n\n    const refreshChatty = useCallback(async () => {\n        await updateThreads(false, false, true)\n        window.scrollTo(0, 0)\n    }, [updateThreads])\n\n    // full load of chatty on start and when required\n    useEffect(() => {\n        const fullReload = async () => {\n            try {\n                setLoading('async')\n\n                const {eventId} = await fetchJson('getNewestEventId')\n                await updateThreads(true, true, false)\n                setLastEventId(eventId)\n            } catch (ex) {\n                showSnackbar('Error loading chatty. Content may not be current.', {variant: 'error'})\n                console.error('Exception while doing full reload.', ex)\n                setTimeout(() => fullReload(), 30000)\n            } finally {\n                setLoading(false)\n            }\n        }\n        if (lastEventId === 0) fullReload()\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [lastEventId])\n\n    // wait for and handle events\n    useEffect(() => {\n        let mounted = true\n        const waitForEvent = async () => {\n            if (mounted && lastEventId) {\n                try {\n                    const {lastEventId: newerEventId, events, error} = await fetchJson(`waitForEvent?lastEventId=${lastEventId}`)\n\n                    if (mounted) {\n                        if (!error) {\n                            if (newerEventId > lastEventId) {\n                                const newChatty = events\n                                    .reduce((current, event) => handleEvent(event, current), chatty)\n                                setChatty(newChatty)\n                                setLastEventId(newerEventId)\n                            } else {\n                                // No changes\n                                return waitForEvent(lastEventId)\n                            }\n                        } else {\n                            console.error('Error from API:waitForLastEvent call.', error)\n                            showSnackbar('Error receiving events. Reloading full chatty.', {variant: 'error'})\n                            setLastEventId(0)\n                        }\n                    }\n                } catch (ex) {\n                    showSnackbar('Error receiving events. Reloading full chatty.', {variant: 'error'})\n                    console.error('Exception from API:waitForLastEvent call.', ex)\n                    setLastEventId(0)\n                }\n            }\n        }\n\n        if (lastEventId) waitForEvent(lastEventId)\n        return () => mounted = false\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [lastEventId])\n\n    const contextValue = useMemo(() => ({\n        ...chatty,\n        refreshChatty\n    }), [chatty, refreshChatty])\n\n    return (\n        <ChattyContext.Provider value={contextValue}>\n            {children}\n        </ChattyContext.Provider>\n    )\n}\n\nexport default ChattyProvider\n","import React from 'react'\nimport LinearProgress from '@material-ui/core/LinearProgress'\nimport {makeStyles} from '@material-ui/styles'\n\nfunction AsyncLoadingIndicator({loading}) {\n    const classes = useStyles()\n    if (loading !== 'async') return null\n    return <LinearProgress className={classes.progress} color='secondary'/>\n}\n\nconst useStyles = makeStyles({\n    progress: {\n        zIndex: 9999,\n        position: 'fixed',\n        top: 0,\n        width: '100vw'\n    }\n})\n\nexport default AsyncLoadingIndicator\n","import React from 'react'\nimport CircularProgress from '@material-ui/core/CircularProgress'\nimport {makeStyles} from '@material-ui/styles'\n\nfunction SyncLoadingIndicator({loading}) {\n    const classes = useStyles()\n    if (loading !== 'sync') return null\n    return (\n        <div className={classes.container}>\n            <CircularProgress\n                className={classes.progress}\n                size={60}\n                thickness={4}\n                color='secondary'\n            />\n        </div>\n    )\n}\n\nconst useStyles = makeStyles({\n    container: {\n        zIndex: 99999,\n        position: 'fixed',\n        top: 0,\n        left: 0,\n        bottom: 0,\n        right: 0,\n        backgroundColor: 'rgba(0, 0, 0, 0.2)'\n    },\n    progress: {\n        position: 'absolute',\n        top: 'calc(50% - 60px)',\n        left: 'calc(50% - 60px)'\n    }\n})\n\nexport default SyncLoadingIndicator\n","import React, {useMemo, useState} from 'react'\nimport IndicatorContext from './IndicatorContext'\nimport AsyncLoadingIndicator from './AsyncLoadingIndicator'\nimport SyncLoadingIndicator from './SyncLoadingIndicator'\nimport {useSnackbar} from 'notistack'\n\nfunction IndicatorProvider({children}) {\n    const [loading, setLoading] = useState(false)\n    const {enqueueSnackbar} = useSnackbar()\n\n    const contextValue = useMemo(() => ({\n        setLoading,\n        showSnackbar: enqueueSnackbar\n    }), [enqueueSnackbar])\n\n    return (\n        <IndicatorContext.Provider value={contextValue}>\n            <SyncLoadingIndicator loading={loading}/>\n            <AsyncLoadingIndicator loading={loading}/>\n            {children}\n        </IndicatorContext.Provider>\n    )\n}\n\nexport default IndicatorProvider\n","import React from 'react'\n\nexport default React.createContext({})\n","import React, {useCallback, useContext, useEffect, useState, useMemo} from 'react'\nimport FilterContext from './FilterContext'\nimport ClientDataContext from '../clientData/ClientDataContext'\nimport IndicatorContext from '../indicators/IndicatorContext'\nimport {cleanAllStyles} from '../../util/bodyUtils'\n\nfunction FilterProvider({children}) {\n    const {clientData, updateClientData} = useContext(ClientDataContext)\n    const [filterSettings, setFilterSettings] = useState(defaultSettings)\n    const {showSnackbar} = useContext(IndicatorContext)\n\n    const updateCloudFilterSettings = useCallback(async cloudFilterSettings => {\n        try {\n            await updateClientData('filterSettings', cloudFilterSettings)\n        } catch (err) {\n            console.error('Error updating clientData.filterSettings.')\n            showSnackbar('Error updating filter settings, changes may have been lost.', {variant: 'error'})\n        }\n    }, [showSnackbar, updateClientData])\n\n    useEffect(() => {\n        try {\n            if (clientData && clientData.filterSettings) {\n                const {filterSettings: cfs} = clientData\n                setFilterSettings({\n                    filteredTerms: (cfs.filteredTerms || [])\n                        .map(text => ({text, regex: new RegExp(text, 'mi')})),\n                    filteredUsers: (cfs.filteredUsers || [])\n                        .map(text => ({text, regex: new RegExp(text, 'mi')})),\n                    showCollapsed: !!cfs.showCollapsed,\n                    showFilteredTerms: !!cfs.showFilteredTerms,\n                    showFilteredUsers: !!cfs.showFilteredUsers,\n                })\n            }\n        } catch (ex) {\n            console.error('Error parsing clientData.filterSettings, resetting to default.')\n            showSnackbar('Error loading filter settings, resetting to default.', {variant: 'error'})\n            updateCloudFilterSettings(defaultSettings)\n            setFilterSettings(defaultSettings)\n        }\n    }, [clientData, showSnackbar, updateCloudFilterSettings])\n\n    const isPostVisible = useCallback((thread, post = thread) => {\n        const {\n            showCollapsed,\n            showFilteredUsers,\n            filteredUsers,\n            showFilteredTerms,\n            filteredTerms\n        } = filterSettings\n\n        if (!showCollapsed && thread.markType === 'collapsed') return false\n        else if (!showFilteredUsers && filteredUsers.some(({regex}) => regex.test(post.author))) return false\n        else if (!showFilteredTerms && filteredTerms.some(({regex}) => regex.test(cleanAllStyles(post.body)))) return false\n\n        return true\n    }, [filterSettings])\n\n    const updateFilterSettings = useCallback(async updatedSettings => {\n        const newFilterSettings = {...filterSettings, ...updatedSettings}\n        const cloudFilterSettings = {\n            ...newFilterSettings,\n            filteredTerms: newFilterSettings.filteredTerms.map(item => item.text),\n            filteredUsers: newFilterSettings.filteredUsers.map(item => item.text)\n        }\n\n        updateCloudFilterSettings(cloudFilterSettings)\n        setFilterSettings(newFilterSettings)\n    }, [filterSettings, updateCloudFilterSettings])\n\n    const contextValue = useMemo(() => ({\n        filterSettings,\n        updateFilterSettings,\n        isPostVisible\n    }), [filterSettings, isPostVisible, updateFilterSettings])\n\n    return (\n        <FilterContext.Provider value={contextValue}>\n            {children}\n        </FilterContext.Provider>\n    )\n}\n\nconst defaultSettings = {\n    filteredTerms: [],\n    filteredUsers: [],\n    showCollapsed: false,\n    showFilteredTerms: false,\n    showFilteredUsers: false\n}\n\nexport default FilterProvider\n","import * as history from 'history'\nexport default history.createBrowserHistory({})\n","import React, {useCallback, useContext, useEffect, useState, useMemo} from 'react'\nimport ClientDataContext from './ClientDataContext'\nimport fetchJson from '../../util/fetchJson'\nimport AuthContext from '../auth/AuthContext'\nimport querystring from 'querystring'\nimport IndicatorContext from '../indicators/IndicatorContext'\n\nfunction ClientDataProvider({children}) {\n    const [clientData, setClientData] = useState({})\n    const {isLoggedIn, username} = useContext(AuthContext)\n    const {showSnackbar} = useContext(IndicatorContext)\n\n    const updateClientData = useCallback(async (key, value) => {\n        try {\n            const newClientData = {\n                ...clientData\n            }\n            if (key) newClientData[key] = value\n            const data = JSON.stringify(newClientData)\n            const body = {client, username: encodeURIComponent(username), data}\n            const result = await fetchJson(`clientData/setClientData`, {method: 'POST', body})\n            if (result.error) {\n                showSnackbar('Error updating user preferences.', {variant: 'error'})\n                console.error('Error setting client data', result)\n            }\n        } catch (ex) {\n            showSnackbar('Error updating user preferences.', {variant: 'error'})\n            console.error('Error setting client data', ex)\n        }\n    }, [clientData, showSnackbar, username])\n    \n    useEffect(() => {\n        const loadClientData = async () => {\n            if (isLoggedIn) {\n                try {\n                    const params = querystring.stringify({client, username: encodeURIComponent(username)})\n                    const {data: string = '{}'} = await fetchJson(`clientData/getClientData?${params}`)\n                    const data = JSON.parse(string)\n                    setClientData(data)\n                } catch (ex) {\n                    showSnackbar('Error loading user preferences.', {variant: 'error'})\n                    console.error('Error loading client data', ex)\n                    setClientData({})\n                    // TODO: Reset client data in cloud?\n                }\n            } else {\n                setClientData({})\n            }\n        }\n        \n        loadClientData()\n    }, [isLoggedIn, showSnackbar, username])\n\n    const contextValue = useMemo(() => ({\n        clientData,\n        updateClientData\n    }), [clientData, updateClientData])\n\n    if (isLoggedIn && !clientData) return null\n    return (\n        <ClientDataContext.Provider value={contextValue}>\n            {children}\n        </ClientDataContext.Provider>\n    )\n}\n\nconst client = 'nixxedchatty'\n\nexport default ClientDataProvider\n","import React from 'react'\nimport {ThemeProvider} from '@material-ui/styles'\nimport Theme from './Theme'\nimport App from './App'\nimport AuthProvider from '../context/auth/AuthProvider'\nimport ChattyProvider from '../context/chatty/ChattyProvider'\nimport './global.css'\nimport './shacktags.css'\nimport './comment_tree.css'\nimport IndicatorProvider from '../context/indicators/IndicatorProvider'\nimport FilterProvider from '../context/filter/FilterProvider'\nimport {Router} from 'react-router-dom'\nimport history from '../history'\nimport ClientDataProvider from '../context/clientData/ClientDataProvider'\nimport {SnackbarProvider} from 'notistack'\n\nfunction Root() {\n    return (\n        <Router history={history}>\n            <ThemeProvider theme={Theme}>\n                <SnackbarProvider>\n                    <IndicatorProvider>\n                        <AuthProvider>\n                            <ClientDataProvider>\n                                <FilterProvider>\n                                    <ChattyProvider>\n                                        <App/>\n                                    </ChattyProvider>\n                                </FilterProvider>\n                            </ClientDataProvider>\n                        </AuthProvider>\n                    </IndicatorProvider>\n                </SnackbarProvider>\n            </ThemeProvider>\n        </Router>\n    )\n}\n\nexport default Root\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport Root from './app/Root'\n\nconst render = Component => ReactDOM.render(<Component/>, document.getElementById('root'))\n\nrender(Root)\n\nif (module.hot) {\n    module.hot.accept('./app/Root', () => {\n        const next = require('./app/Root').default\n        render(next)\n    })\n}\n"],"sourceRoot":""}