(this.webpackJsonpchatty=this.webpackJsonpchatty||[]).push([[0],{171:function(e,t,r){e.exports=r(218)},206:function(e,t,r){},207:function(e,t,r){},208:function(e,t,r){},218:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r.n(n),o=r(13),c=r.n(o),l=r(201),s=r(93),i=r.n(s)()({palette:{type:"dark",primary:{light:"#6fbf73",main:"#357a38",dark:"#357a38"},secondary:{light:"#33eaff",main:"#00e5ff",dark:"#00a0b2"}},typography:{useNextVariants:!0}}),u=r(281),p=r(9),d=r(274),f=r(275),m=r(263),b=r(135),h=r.n(b),g=r(262),v=r(35),O=r(145),y=r(261),E=r(7),x=r.n(E),w=r(14),j=r(255),k=r(256),C=r(257),S=r(260),P=r(279),T=a.a.createContext({}),I=a.a.createContext({});var N=function(e){var t=e.open,r=e.onClose,o=Object(n.useState)(""),c=Object(p.a)(o,2),l=c[0],s=c[1],i=Object(n.useState)(""),u=Object(p.a)(i,2),d=u[0],f=u[1],m=Object(n.useContext)(T).login,b=Object(n.useContext)(I).setLoading,h=function(){var e=Object(w.a)(x.a.mark((function e(t){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,b("sync"),e.next=5,m(l,d);case 5:r();case 6:return e.prev=6,b(!1),e.finish(6);case 9:case"end":return e.stop()}}),e,null,[[1,,6,9]])})));return function(t){return e.apply(this,arguments)}}();return a.a.createElement(j.a,{open:t,onClose:r},a.a.createElement("form",{onSubmit:h},a.a.createElement(k.a,null,"Log in"),a.a.createElement(C.a,null,a.a.createElement(P.a,{autoFocus:!0,margin:"dense",label:"Username",type:"text",fullWidth:!0,onChange:function(e){return s(e.target.value)}}),a.a.createElement(P.a,{margin:"dense",label:"Password",type:"password",fullWidth:!0,onChange:function(e){return f(e.target.value)}})),a.a.createElement(S.a,null,a.a.createElement(y.a,{onClick:r},"Cancel"),a.a.createElement(y.a,{type:"submit"},"Log in"))))};var D=function(){var e=Object(n.useState)(!1),t=Object(p.a)(e,2),r=t[0],o=t[1];return a.a.createElement(a.a.Fragment,null,a.a.createElement(y.a,{onClick:function(){return o(!0)}},"Log in"),a.a.createElement(N,{open:r,onClose:function(){return o(!1)}}))};var F=function(e){var t=e.onClick,r=Object(n.useContext)(T).logout;return a.a.createElement(g.a,{onClick:function(){t&&t(),r()}},"Logout")},R=r(264),B=r(128),L=r.n(B);var M=function(){var e=Object(n.useContext)(T),t=e.isLoggedIn,r=e.username,o=Object(n.useState)(null),c=Object(p.a)(o,2),l=c[0],s=c[1];return t?a.a.createElement(a.a.Fragment,null,a.a.createElement(m.a,{size:"small",onClick:function(e){return s(e.target)}},a.a.createElement(L.a,null)),l&&a.a.createElement(O.a,{keepMounted:!0,open:!!l,anchorEl:l,onClose:function(){return s(null)}},a.a.createElement(g.a,{disabled:!0},r),a.a.createElement(R.a,null),a.a.createElement(F,{onClick:function(){return s(null)}}))):a.a.createElement(D,null)},U=r(265),z=r(99),_=r.n(z),J=r(266),W=a.a.createContext({}),V=r(104);var H=Object(V.a)({badge:{}}),A=function(){var e=H(),t=Object(n.useContext)(W),r=t.newThreads,o=t.refreshChatty,c=r&&r.length>0,l=c?"Refresh Thread Order (".concat(r.length," new threads)"):"Refresh Thread Order",s=function(){var e=Object(w.a)(x.a.mark((function e(){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o();case 2:window.scrollTo(0,0);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return a.a.createElement(U.a,{disableFocusListener:!0,title:l,enterDelay:350},a.a.createElement(m.a,{size:"small",onClick:s},c?a.a.createElement(J.a,{color:"secondary",classes:{badge:e.badge},variant:"dot",anchorOrigin:{vertical:"top",horizontal:"left"}},a.a.createElement(_.a,null)):a.a.createElement(_.a,null)))},q=r(81),K=r.n(q),G=r(267),Q=r(268),X=r(270),Y=r(269),Z=r(258),$=r(27),ee=r(56),te=r.n(ee);function re(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ne(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?re(r,!0).forEach((function(t){Object($.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):re(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ae=function(){var e=Object(w.a)(x.a.mark((function e(t){var r,n,a,o,c,l,s=arguments;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=s.length>1&&void 0!==s[1]?s[1]:{}).body&&(r=ne({},r,{headers:ne({"Content-Type":"application/x-www-form-urlencoded"},r.headers),body:te.a.stringify(r.body)})),e.next=4,fetch("".concat("https://winchatty.com/v2","/").concat(t),r);case 4:if(!(n=e.sent).ok){e.next=11;break}return e.next=8,oe(n);case 8:return e.abrupt("return",e.sent);case 11:return e.next=13,oe(n);case 13:return a=e.sent,o=n.status,c=n.statusText,l={status:o,statusText:c,body:a},console.error("Http Error:",l),e.abrupt("return",Promise.reject(l));case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),oe=function(){var e=Object(w.a)(x.a.mark((function e(t){var r;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.text();case 2:return r=e.sent,e.prev=3,e.abrupt("return",JSON.parse(r));case 7:return e.prev=7,e.t0=e.catch(3),e.abrupt("return",r);case 10:case"end":return e.stop()}}),e,null,[[3,7]])})));return function(t){return e.apply(this,arguments)}}(),ce=r(20),le=r.n(ce);var se=Object(V.a)({card:{backgroundColor:"#202224",borderRadius:0,border:"1px solid #656565"},actions:{margin:"-8px 0 8px 8px"},flexRow:{display:"flex",flexDirection:"row"},textarea:{flex:1,backgroundColor:"#000",padding:4}}),ie=function(e){var t=e.onCloseReplyBox,r=e.parentId,o=e.className,c=se(),l=Object(n.useContext)(T),s=l.username,i=l.password,u=Object(n.useContext)(I),d=u.setLoading,f=u.showSnackbar,m=Object(n.useState)(""),b=Object(p.a)(m,2),h=b[0],g=b[1],v=Object(n.useState)(!1),O=Object(p.a)(v,2),E=O[0],j=O[1],k=function(){var e=Object(w.a)(x.a.mark((function e(){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,d("async"),j(!0),e.next=5,ae("postComment",{method:"POST",body:{username:s,password:i,parentId:r,text:h}});case 5:"success"===e.sent.result&&t(),e.next=14;break;case 9:e.prev=9,e.t0=e.catch(0),console.log("Error while posting comment",e.t0),f("Error while posting. Please try again later.",{variant:"error"}),j(!1);case 14:return e.prev=14,d(!1),e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[0,9,14,17]])})));return function(){return e.apply(this,arguments)}}();return a.a.createElement(G.a,{className:le()(o,c.card)},0===r&&a.a.createElement(Q.a,{title:"New Thread"}),a.a.createElement(Y.a,null,a.a.createElement("div",{className:c.flexRow},a.a.createElement(Z.a,{multiline:!0,autoFocus:!0,disableUnderline:!0,rows:5,fullWidth:!0,className:c.textarea,placeholder:"Type something interesting...",name:"replyBody",required:!0,disabled:E,onChange:function(e){return g(e.target.value)}}))),a.a.createElement(X.a,{className:c.actions},a.a.createElement(y.a,{color:"primary",variant:"outlined",disabled:E||!h.length,onClick:k},"Post"),a.a.createElement(y.a,{variant:"outlined",disabled:E,onClick:t},"Cancel")))};var ue=Object(V.a)({dialogPaper:{width:"85vw"}}),pe=function(){var e=ue(),t=Object(n.useContext)(T).isLoggedIn,r=Object(n.useState)(!1),o=Object(p.a)(r,2),c=o[0],l=o[1];return t?a.a.createElement(a.a.Fragment,null,a.a.createElement(U.a,{disableFocusListener:!0,title:"New Thread",enterDelay:350},a.a.createElement(m.a,{size:"small",onClick:function(){return l(!0)}},a.a.createElement(K.a,null))),a.a.createElement(j.a,{open:c,onClose:function(){return l(!1)},classes:{paper:e.dialogPaper}},a.a.createElement(ie,{parentId:0,onCloseReplyBox:function(){return l(!1)}}))):null},de=r(100),fe=r.n(de);var me=Object(V.a)({badge:{top:12}}),be=function(){var e=me(),t=Object(n.useContext)(T),r=t.isLoggedIn,o=t.username,c=t.password,l=Object(n.useState)(0),s=Object(p.a)(l,2),i=s[0],u=s[1],d=Object(n.useState)(0),f=Object(p.a)(d,2),b=f[0],h=f[1],g=b>0,v="( ".concat(b," / ").concat(i," ) unread messages");return Object(n.useEffect)((function(){var e=function(){var e=Object(w.a)(x.a.mark((function e(){var t,n,a,l;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=9;break}return t={method:"POST",body:{username:o,password:c}},e.next=4,ae("getMessageCount",t);case 4:n=e.sent,a=n.total,l=n.unread,u(a),h(l);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e();var t=setInterval((function(){return e()}),9e5);return function(){return clearInterval(t)}}),[r,c,o]),r?a.a.createElement(U.a,{disableFocusListener:!0,title:v,enterDelay:350},a.a.createElement(m.a,{size:"small",href:"https://www.shacknews.com/messages",target:"_blank"},g?a.a.createElement(J.a,{badgeContent:b,color:"secondary",classes:{badge:e.badge}},a.a.createElement(fe.a,null)):a.a.createElement(fe.a,null))):null},he=r(133),ge=r.n(he),ve=r(134),Oe=r.n(ve),ye=r(132),Ee=r.n(ye),xe=a.a.createContext({}),we=r(259),je=r(222),ke=r(272),Ce=r(271),Se=r(131),Pe=r.n(Se),Te=r(130),Ie=r.n(Te),Ne=r(82),De=r.n(Ne);var Fe=Object(V.a)({row:{display:"flex",flexDirection:"row"},fill:{display:"flex",flex:1},container:{marginTop:12},title:{marginTop:6}}),Re=function(e){var t=e.title,r=e.value,o=e.onChange,c=Fe(),l=Object(n.useState)(!1),s=Object(p.a)(l,2),i=s[0],u=s[1],d=Object(n.useState)(""),f=Object(p.a)(d,2),b=f[0],h=f[1],g=Object(n.useContext)(I).showSnackbar,O=function(){try{if(b.length){var e=new RegExp(b,"gmi"),t={text:b,regex:e};o&&o(r.concat([t])),u(!1),h("")}}catch(n){g("Invalid filter term.",{variant:"error"}),console.error("Error processing new filter value",b,n)}};return a.a.createElement("div",{className:c.container},a.a.createElement("div",{className:c.row},i?a.a.createElement(a.a.Fragment,null,a.a.createElement(P.a,{placeholder:"Add new ".concat(t.toLowerCase()),margin:"none",autoFocus:!0,className:c.fill,value:b,onKeyPress:function(e){return"Enter"===e.key&&O()},onChange:function(e){return h(e.target.value)}}),a.a.createElement(m.a,{onClick:function(){return O()}},a.a.createElement(Ie.a,{fontSize:"small"})),a.a.createElement(m.a,{onClick:function(){return u(!1)}},a.a.createElement(De.a,{fontSize:"small"}))):a.a.createElement(a.a.Fragment,null,a.a.createElement(v.a,{variant:"subtitle1",className:le()(c.title,c.fill)},t,"s"),a.a.createElement(m.a,{disableRipple:!0,onClick:function(){return u(!0)}},a.a.createElement(K.a,{fontSize:"small"})))),a.a.createElement(we.a,{dense:!0},0===r.length&&a.a.createElement(je.a,{dense:!0},a.a.createElement(Ce.a,{primary:"List is empty."})),r.length>0&&r.map((function(e,t){return a.a.createElement(je.a,{key:t,dense:!0},a.a.createElement(Ce.a,{primary:e.text}),a.a.createElement(ke.a,null,a.a.createElement(m.a,{onClick:function(){return t=e,o&&o(r.filter((function(e){return e!==t})));var t}},a.a.createElement(Pe.a,{fontSize:"small"}))))}))))},Be=r(280),Le=r(273);var Me=Object(V.a)({checkbox:{marginBottom:-12}}),Ue=function(e){var t=e.label,r=e.checked,n=e.onChange,o=Me();return a.a.createElement(Le.a,{label:t,className:o.checkbox,control:a.a.createElement(Be.a,{checked:r,onChange:n})})};var ze=Object(V.a)({content:{display:"flex",flexDirection:"column",width:300},checkboxes:{marginTop:12}}),_e=function(e){var t=e.open,r=e.onClose,o=ze(),c=Object(n.useContext)(xe),l=c.filterSettings,s=c.updateFilterSettings,i=Object(n.useContext)(I).setLoading,u=Object(n.useState)(l.showCollapsed),d=Object(p.a)(u,2),f=d[0],m=d[1],b=Object(n.useState)(l.showFilteredTerms),h=Object(p.a)(b,2),g=h[0],O=h[1],E=Object(n.useState)(l.showFilteredUsers),P=Object(p.a)(E,2),T=P[0],N=P[1],D=Object(n.useState)(l.filteredTerms),F=Object(p.a)(D,2),R=F[0],B=F[1],L=Object(n.useState)(l.filteredUsers),M=Object(p.a)(L,2),U=M[0],z=M[1],_=function(){var e=Object(w.a)(x.a.mark((function e(){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i("sync"),e.next=4,s({showCollapsed:f,filteredTerms:R,filteredUsers:U});case 4:r();case 5:return e.prev=5,i(!1),e.finish(5);case 8:case"end":return e.stop()}}),e,null,[[0,,5,8]])})));return function(){return e.apply(this,arguments)}}();return a.a.createElement(j.a,{open:t,onClose:r},a.a.createElement(k.a,null,"Filter Settings"),a.a.createElement(C.a,{className:o.content},a.a.createElement(v.a,{variant:"caption",color:"textSecondary"},"These settings adjust what posts display in the chatty. Filtered keywords will hide any posts that match. Filtered users will hide any posts or replies by that user. Terms support full regular expressions. Checking a checkbox will show posts even if they match that criteria."),a.a.createElement(Re,{title:"Term",value:R,onChange:function(e){return B(e)}}),a.a.createElement(Re,{title:"User",value:U,onChange:function(e){return z(e)}}),a.a.createElement("div",{className:o.checkboxes},a.a.createElement(Ue,{label:"Show Collapsed Threads",checked:f,onChange:function(){return m(!f)}}),a.a.createElement(Ue,{label:"Show Filtered Terms",checked:g,onChange:function(){return O(!g)}}),a.a.createElement(Ue,{label:"Show Filtered Users",checked:T,onChange:function(){return N(!T)}}))),a.a.createElement(S.a,null,a.a.createElement(y.a,{onClick:r},"Cancel"),a.a.createElement(y.a,{onClick:_},"Save")))};var Je=function(){var e=Object(n.useState)(!1),t=Object(p.a)(e,2),r=t[0],o=t[1],c=Object(n.useState)(!1),l=Object(p.a)(c,2),s=l[0],i=l[1];return a.a.createElement(a.a.Fragment,null,a.a.createElement(Ee.a,{disableFocusListener:!0,title:"Filter Settings",enterDelay:350},a.a.createElement(ge.a,{size:"small",onClick:function(){return o(!0)||i(!0)}},a.a.createElement(Oe.a,null))),s&&a.a.createElement(_e,{open:r,onClose:function(){return o(!1)}}))},We=r(276);var Ve=Object(V.a)({white:{color:"#fff"},title:{color:"#fff",flex:1},menuButton:{marginLeft:-15,marginRight:8},menuItem:{textDecoration:"none",color:"inherit"}}),He=function(){var e=Ve(),t=Object(n.useState)(!1),r=Object(p.a)(t,2),o=r[0],c=r[1],l=function(){return c(!1)};return a.a.createElement(a.a.Fragment,null,a.a.createElement(d.a,{elevation:0},a.a.createElement(f.a,{variant:"dense"},a.a.createElement(m.a,{size:"small",className:e.menuButton,onClick:function(){return c(!o)}},a.a.createElement(h.a,{className:e.white})),a.a.createElement(v.a,{variant:"h5",className:e.title},"Chatty"),a.a.createElement(A,null),a.a.createElement(pe,null),a.a.createElement(Je,null),a.a.createElement(be,null),a.a.createElement(M,null))),a.a.createElement(We.a,{open:o,onClose:l,className:e.drawer},a.a.createElement(d.a,{position:"static",color:"primary",className:e.drawerAppBar},a.a.createElement(f.a,{variant:"dense"},a.a.createElement(v.a,{variant:"h6",className:e.title},"Latest Chatty"))),a.a.createElement("a",{href:"https://github.com/latestchatty/chatty",target:"_blank",rel:"noopener noreferrer",className:e.menuItem},a.a.createElement(g.a,{onClick:l},"Contribute")),a.a.createElement("a",{href:"https://github.com/latestchatty/chatty/issues",target:"_blank",rel:"noopener noreferrer",className:e.menuItem},a.a.createElement(g.a,{onClick:l},"Feedback"))))},Ae=r(138),qe=r.n(Ae),Ke=r(139),Ge=r.n(Ke),Qe=r(140),Xe=r.n(Qe),Ye=r(137),Ze=r.n(Ye);var $e=Object(V.a)({wrapper:{height:8,width:48,margin:7,background:"rgb(221, 221, 221) -webkit-gradient(\n                linear,\n                0% 0%,\n                0% 100%,\n                from(rgb(170, 170, 170)),\n                color-stop(0.4, rgb(204, 204, 204)),\n                color-stop(0.6, rgb(204, 204, 204)),\n                to(rgb(238, 238, 238))\n            )"},value:{height:8,backgroundImage:"-webkit-gradient(\n                linear,\n                0 100%,\n                100% 0,\n                color-stop(0.25, rgba(255, 255, 255, 0.4)),\n                color-stop(0.25, transparent),\n                color-stop(0.5, transparent),\n                color-stop(0.5, rgba(255, 255, 255, 0.4)),\n                color-stop(0.75, rgba(255, 255, 255, 0.4)),\n                color-stop(0.75, transparent),\n                to(transparent)\n            )",backgroundSize:"25px 25px",boxShadow:"rgba(255, 255, 255, 0.298039) 0 2px 4px inset, rgba(0, 0, 0, 0.4) 0 -2px 3px inset"}}),et=function(e){var t=e.date,r=$e(),n=(new Date).getTime(),o=new Date(t).getTime(),c=Math.min((n-o)/36e5/18*100,100),l="red";return c<=25?l="springgreen":c<=50?l="yellow":c<=75&&(l="orange"),a.a.createElement("div",{className:r.wrapper},a.a.createElement("div",{className:r.value,style:{width:"".concat(c,"%"),backgroundColor:l}}))},tt=r(143),rt=r(144),nt=r(83);var at=Object(V.a)({date:{fontSize:10,color:"#888",paddingTop:3,marginRight:3}}),ot=function(e){var t=e.date,r=at(),n=Object(nt.a)(t);return a.a.createElement(U.a,{disableFocusListener:!0,title:Object(tt.a)(n,"MMM dd, yyyy h:mma"),enterDelay:350},a.a.createElement("div",{className:r.date},Object(rt.a)(n)," ago"))};var ct=["themanwiththebriefcase","shacknews"],lt=[],st=Object(V.a)({user:{fontSize:14,fontWeight:"bold",cursor:"pointer","&:hover":{textDecoration:"underline"}},normal:{color:"#f3e7b5"},self:{color:"#6cf"},op:{color:"#6aff94"},mod:{color:"#d20000"},employee:{color:"#9370db"}}),it=function(e){var t=e.post,r=void 0===t?{}:t,o=e.thread,c=void 0===o?{}:o,l=st(),s=Object(n.useContext)(T).username,i=r.author,u=void 0===i?"":i,p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=e.toLowerCase().replace(/\s/g,""),n=t.toLowerCase().replace(/\s/g,"");return r===n},d=Object(n.useMemo)((function(){return s&&p(u,s)?"self":c.id!==r.id&&p(c.author,u)?"op":ct.find((function(e){return p(e,u)}))?"employee":lt.find((function(e){return p(e,u)}))?"mod":"normal"}),[s,u,c.id,r.id,c.author]),f=Object(n.useMemo)((function(){return u.replace(/\s/g,String.fromCharCode(160))}),[u]);return a.a.createElement("span",{className:le()(l.user,l[d])},f)},ut=r(66),pt=r(282),dt=["lol","inf","unf","wtf"];var ft=Object(V.a)({containerPost:{marginLeft:12},containerOneline:{marginLeft:4,whiteSpace:"nowrap"},chip:{height:16,marginTop:2,marginRight:6,fontSize:10},nonChip:{marginRight:4,fontSize:9},lolBorder:{border:"1px solid #f80"},infBorder:{border:"1px solid #09c"},unfBorder:{border:"1px solid #f00"},wtfBorder:{border:"1px solid #c000c0"},tagBorder:{border:"1px solid #bbaf57"},lol:{color:"#f80"},inf:{color:"#09c"},unf:{color:"#f00"},wtf:{color:"#c000c0"},tag:{color:"#bbaf57"}}),mt=function(e){var t=e.tags,r=void 0===t?[]:t,o=e.variant,c=ft(),l=Object(n.useMemo)((function(){var e=r.filter((function(e){return dt.includes(e.tag)})),t=r.filter((function(e){return!dt.includes(e.tag)})).reduce((function(e,t){return e+t.count}),0);return[].concat(Object(ut.a)(e),[{tag:"tag",count:t}])}),[r]);return a.a.createElement("div",{className:"post"===o?c.containerPost:c.containerOneline},l.map((function(e){return e.count<1?null:"post"===o?a.a.createElement(pt.a,{key:e.tag,className:le()(c.chip,c[e.tag],c["".concat(e.tag,"Border")]),label:"".concat(e.count," ").concat(e.tag),variant:"outlined"}):"oneline"===o?a.a.createElement("span",{key:e.tag,className:le()(c.nonChip,c[e.tag])},"".concat(e.count," ").concat(e.tag)):null})))},bt=r(136),ht=r.n(bt);var gt=function(e){var t=e.className,r=e.postId,o=Object(n.useContext)(T),c=o.isLoggedIn,l=o.username,s=Object(n.useContext)(I),i=s.setLoading,u=s.showSnackbar,d=Object(n.useState)(null),f=Object(p.a)(d,2),m=f[0],b=f[1],h=dt.map((function(e){return e.toUpperCase()})),v=function(){var e=Object(w.a)(x.a.mark((function e(t){var n;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i("async"),b(null),e.next=5,y(l,r,t);case 5:if(!(n=e.sent).includes("already tagged")){e.next=10;break}return e.next=9,y(l,r,t,"untag");case 9:n=e.sent;case 10:n.match(/^ok /)||console.warn("Error tagging post",n),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(0),console.error("Exception while tagging post",e.t0),u("Error while tagging post. Please try again later.",{variant:"error"});case 17:return e.prev=17,i(!1),e.finish(17);case 20:case"end":return e.stop()}}),e,null,[[0,13,17,20]])})));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=Object(w.a)(x.a.mark((function e(t,r,n,a){var o,c;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://lol.lmnopc.com/report.php",o={who:t,what:r,tag:n,version:-1},a&&(o.action=a),e.next=5,fetch("".concat("https://lol.lmnopc.com/report.php","?").concat(te.a.stringify(o)),{method:"POST"});case 5:return c=e.sent,e.abrupt("return",c.text());case 7:case"end":return e.stop()}}),e)})));return function(t,r,n,a){return e.apply(this,arguments)}}();return c?a.a.createElement(a.a.Fragment,null,a.a.createElement(U.a,{disableFocusListener:!0,title:"Tag Post",enterDelay:350},a.a.createElement(ht.a,{className:t,onClick:function(e){return b(e.target)}})),m&&a.a.createElement(O.a,{keepMounted:!0,open:!!m,anchorEl:m,onClose:function(){return b(null)}},h.map((function(e){return a.a.createElement(g.a,{key:e,onClick:function(){return v(e)}},e)})))):null};var vt=function(e){var t=e.post,r=Object(n.useMemo)((function(){var e=t.body;return"Shacknews"===t.author&&(e=t.body.replace('href="/','href="https://www.shacknews.com/')),{__html:e}}),[t.body,t.author]);return a.a.createElement("span",{dangerouslySetInnerHTML:r})};var Ot=Object(V.a)({card:{backgroundColor:"#202224",borderRadius:0,marginBottom:3},replyBorder:{border:"1px solid #656565"},replyBox:{marginTop:-3},tagNws:{borderLeft:"3px solid red !important"},tagInformative:{borderLeft:"3px solid #00bff3 !important"},tagFrontpage:{borderLeft:"3px solid mediumpurple !important"},content:{maxWidth:"calc(100vw - 32)",color:"lightgray",fontSize:13,padding:"8px 16px"},header:{backgroundColor:"#373a3c",padding:"3px 3px 3px 16px",display:"flex",flexDirection:"row"},actions:{height:34,padding:"0 8px 0 8px"},flex:{flex:1},toolbarButton:{width:18,height:18,cursor:"pointer",color:"#fff",marginRight:6},collapsed:{color:"#f00 !important"},pinned:{color:"#fcbf20 !important"}}),yt=function(e){var t=e.post,r=e.thread,o=e.onCollapse,c=e.onPinned,l=e.replyBoxOpenForId,s=e.onOpenReplyBox,i=e.onCloseReplyBox,u=Ot(),p=Object(n.useRef)(null),d=Object(n.useContext)(T).isLoggedIn,f=Object(n.useContext)(xe).isPostVisible,m=Object(n.useMemo)((function(){return"nuked"===t.category?null:"nws"===t.category?"tagNws":"informative"===t.category?"tagInformative":/shacknews/i.test(t.author)?"tagFrontpage":null}),[t.category,t.author]),b=t.parentId>0,h=b?"replyBorder":null;return Object(n.useEffect)((function(){if(b){var e=p.current.getBoundingClientRect(),t=Math.max(document.documentElement.clientHeight,window.innerHeight),r=e.bottom<0,n=e.top-t>=0;r?window.scrollTo({left:0,top:p.current.offsetTop-75,behavior:"smooth"}):n&&window.scrollTo({left:0,top:p.current.offsetTop-t+e.height+24,behavior:"smooth"})}}),[b]),Object(n.useMemo)((function(){return f(r,t)}),[f,t,r])?a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{ref:p},a.a.createElement(G.a,{className:le()(u.card,u[m],u[h])},a.a.createElement("div",{className:u.header},a.a.createElement(it,{post:t,thread:r}),a.a.createElement(mt,{tags:t.lols,variant:"post"}),a.a.createElement("span",{className:u.flex}),a.a.createElement(ot,{date:t.date}),0===t.parentId&&a.a.createElement(et,{date:t.date})),a.a.createElement(Y.a,{className:le()("postbody",u.content)},a.a.createElement(vt,{post:t})),a.a.createElement(X.a,{className:u.actions,disableSpacing:!0},a.a.createElement(U.a,{disableFocusListener:!0,title:"collapsed"===t.markType?"Uncollapse":"Collapse",enterDelay:350},a.a.createElement(De.a,{className:le()(u.toolbarButton,"collapsed"===t.markType?u.collapsed:null),onClick:o})),d&&a.a.createElement(U.a,{disableFocusListener:!0,title:"Reply",enterDelay:350},a.a.createElement(Ze.a,{className:u.toolbarButton,onClick:function(){return s(t.id)}})),d&&0===t.parentId&&a.a.createElement(a.a.Fragment,null,"pinned"===t.markType&&a.a.createElement(U.a,{disableFocusListener:!0,title:"Unpin Thread",enterDelay:350},a.a.createElement(qe.a,{className:le()(u.toolbarButton,u.pinned),onClick:c})),"pinned"!==t.markType&&a.a.createElement(U.a,{disableFocusListener:!0,title:"Pin Thread",enterDelay:350},a.a.createElement(Ge.a,{className:u.toolbarButton,onClick:c}))),a.a.createElement(gt,{postId:t.id,className:u.toolbarButton}),a.a.createElement(U.a,{disableFocusListener:!0,title:"View Post @ Shacknews.com",enterDelay:350},a.a.createElement("a",{className:u.toolbarButton,target:"_blank",rel:"noopener noreferrer",href:"http://www.shacknews.com/chatty?id=".concat(t.id,"#item_").concat(t.id)},a.a.createElement(Xe.a,{className:u.toolbarButton})))))),l===t.id&&a.a.createElement(ie,{parentId:t.id,onCloseReplyBox:i,className:u.replyBox})):null},Et=function(e){return e.replace(/(<[^>]+>)/gm,"")},xt=function(e){for(var t=function(e){return e.replace(/(<(?!span)(?!\/span)[^>]+>| tabindex="1")/gm," ")}(e),r=0,n=0,a=!1,o=!1;r<t.length&&n<106;)"<"===t[r]?a=!0:">"===t[r]?a=!1:"&"===t[r]?o=!0:""===t[r]&&o?(o=!1,n++):a||n++,r++;var c=t.slice(0,r).trim();return(r<t.length||!c)&&(c+="..."),c};var wt=Object(V.a)({container:{display:"flex",flexDirection:"row"},separator:{padding:"0 3px",fontSize:11,color:"#fff"},oneline:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis","&:hover":{color:"#fff",backgroundColor:"#233548",cursor:"pointer"}},oneline10:{color:"#777"},oneline9:{color:"#888"},oneline8:{color:"#999"},oneline7:{color:"#aaa"},oneline6:{color:"#bbb"},oneline5:{color:"#ccc"},oneline4:{color:"#ddd"},oneline3:{color:"#eee"},oneline2:{color:"#fff"},oneline1:{color:"#eee",fontWeight:"bold"}}),jt=function(e){var t=e.post,r=e.thread,o=e.onExpandReply,c=wt(),l="oneline".concat(t.recentReplyNumber||9),s=Object(n.useMemo)((function(){return xt(t.body)}),[t.body]);return a.a.createElement("div",{className:c.container},a.a.createElement("span",{className:le()(c.oneline,c[l]),dangerouslySetInnerHTML:{__html:s},onClick:function(){return o(t.id)}}),a.a.createElement(mt,{tags:t.lols,variant:"oneline"}),a.a.createElement(it,{post:t,thread:r}))};var kt=function e(t){var r=t.className,n=t.thread,o=void 0===n?{}:n,c=t.parent,l=void 0===c?o:c,s=t.onCollapseReply,i=t.onExpandReply,u=t.onOpenReplyBox,p=t.expandedReplyId,d=t.replyBoxOpenForId,f=t.onCloseReplyBox;return a.a.createElement("ul",{className:le()("comments",r)},o.posts.filter((function(e){return e.parentId===l.id})).map((function(t){return a.a.createElement("li",{key:t.id},p===t.id?a.a.createElement(yt,{post:t,thread:o,onCollapse:s,replyBoxOpenForId:d,onOpenReplyBox:u,onCloseReplyBox:f}):a.a.createElement(jt,{post:t,thread:o,onExpandReply:i}),a.a.createElement(e,{thread:o,parent:t,expandedReplyId:p,replyBoxOpenForId:d,onExpandReply:i,onCollapseReply:s,onOpenReplyBox:u,onCloseReplyBox:f}))})))};function Ct(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var St=Object(V.a)({thread:{marginBottom:15},truncatedMessage:{color:"#fff",fontWeight:"bold",borderTop:"1px solid #656565",borderBottom:"1px dotted #fff",backgroundColor:"#181818",cursor:"pointer",marginTop:-3,"&:hover":{backgroundColor:"#282828"}},replyCount:{color:"#00bff3"},truncatedContainer:{height:300,overflow:"hidden",position:"relative"},truncatedComments:{position:"absolute !important",bottom:0}}),Pt=a.a.memo((function(e){var t=e.thread,r=St(),o=Object(n.useState)(null),c=Object(p.a)(o,2),l=c[0],s=c[1],i=Object(n.useState)(null),u=Object(p.a)(i,2),d=u[0],f=u[1],m=Object(n.useState)(t.markType),b=Object(p.a)(m,2),h=b[0],g=b[1],v=Object(n.useContext)(T),O=v.username,y=v.isLoggedIn,E=Object(n.useContext)(xe).isPostVisible,j=Object(n.useMemo)((function(){var e=t.posts?t.posts.sort((function(e,t){return e.id-t.id})):[];e.slice(-10).reverse().forEach((function(e,t){return e.recentReplyNumber=t+1}));var r=Object(p.a)(e,1)[0];return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ct(r,!0).forEach((function(t){Object($.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ct(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},t,{},r,{id:+t.threadId,posts:e.filter((function(e){return E(r,e)})),markType:h})}),[t,h,E]),k=Object(n.useState)(j.posts.length>20),C=Object(p.a)(k,2),S=C[0],P=C[1],I=function(){var e=Object(w.a)(x.a.mark((function e(t,r){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(g(r),!y){e.next=10;break}return e.prev=2,e.next=5,ae("clientData/markPost",{method:"POST",body:{username:O,postId:t,type:r}});case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),console.error("Error marking post.",e.t0);case 10:case"end":return e.stop()}}),e,null,[[2,7]])})));return function(t,r){return e.apply(this,arguments)}}(),N=function(e){return f(e)},D=function(){return f(null)};return Object(n.useMemo)((function(){return E(j)}),[E,j])?a.a.createElement("div",{className:r.thread},a.a.createElement(yt,{post:j,thread:j,replyBoxOpenForId:d,onCollapse:function(){return I(j.threadId,"collapsed"!==j.markType?"collapsed":"unmarked")},onOpenReplyBox:N,onCloseReplyBox:D,onPinned:function(){return I(j.threadId,"pinned"!==j.markType?"pinned":"unmarked")}}),S&&a.a.createElement("div",{className:r.truncatedMessage,onClick:function(){return P(!1)}},"Thread truncated. Click to see all\xa0",a.a.createElement("span",{className:r.replyCount},j.posts.length-1),"\xa0replies."),a.a.createElement("div",{className:S?r.truncatedContainer:null},a.a.createElement(kt,{className:S?r.truncatedComments:null,thread:j,expandedReplyId:l,replyBoxOpenForId:d,onExpandReply:function(e){s(e),f(null),P(!1)},onCollapseReply:function(){s(null),f(null)},onOpenReplyBox:N,onCloseReplyBox:D}))):null}));var Tt=Object(V.a)({chatty:{margin:"56px 8px 8px 8px",font:"12px/1.5 arial, helvetica, clean, sans-serif"}}),It=function(){var e=Tt(),t=Object(n.useContext)(W).threads;return a.a.createElement("div",{className:e.chatty},t.map((function(e){return a.a.createElement(Pt,{key:e.threadId,thread:e})})))};var Nt=function(){return a.a.createElement(a.a.Fragment,null,a.a.createElement(He,null),a.a.createElement(u.c,null,a.a.createElement(u.a,{path:"/chatty",component:It}),a.a.createElement(u.a,{component:It})))};function Dt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var Ft=function(e){var t=e.children,r=Object(n.useContext)(I),o=r.setLoading,c=r.showSnackbar,l=Object(n.useState)((function(){try{var e=localStorage.getItem("auth")||"{}",t=JSON.parse(e)||{};return{username:t.username,password:t.password}}catch(r){return console.log("Invalid storage value: auth",r),localStorage.removeItem("auth"),{username:null,password:null}}})),s=Object(p.a)(l,2),i=s[0],u=s[1],d=Object(n.useCallback)(function(){var e=Object(w.a)(x.a.mark((function e(t,r){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,o("async"),e.next=4,ae("verifyCredentials",{method:"POST",body:{username:t,password:r}});case 4:e.sent.isValid?(localStorage.setItem("auth",JSON.stringify({username:t,password:r})),u({username:t,password:r})):(console.log("Invalid login credentials."),c("Invalid username/password. Please check them and try again",{variant:"error"})),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.log("Error while logging in",e.t0),c("Error while logging in. Please try again later.",{variant:"error"});case 12:return e.prev=12,o(!1),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[0,8,12,15]])})));return function(t,r){return e.apply(this,arguments)}}(),[o,c]),f=Object(n.useCallback)((function(){localStorage.removeItem("auth"),u({username:null,password:null})}),[]),m=i.username&&i.password,b=Object(n.useMemo)((function(){return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Dt(r,!0).forEach((function(t){Object($.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Dt(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},i,{isLoggedIn:m,login:d,logout:f})}),[i,m,d,f]);return a.a.createElement(T.Provider,{value:b},t)},Rt=r(146),Bt=r(142);function Lt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Mt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Lt(r,!0).forEach((function(t){Object($.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Lt(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Ut=function(e){var t=e.children,r=Object(n.useContext)(T),o=r.isLoggedIn,c=r.username,l=Object(n.useContext)(I),s=l.setLoading,i=l.showSnackbar,u=Object(n.useRef)({lastUsername:c,threads:[],newThreads:[]}),d=Object(n.useState)(u.current),f=Object(p.a)(d,2),m=f[0],b=f[1],h=Object(n.useState)(0),g=Object(p.a)(h,2),v=g[0],O=g[1],y=Object(n.useCallback)(Object(w.a)(x.a.mark((function e(){var t,r;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o){e.next=6;break}return e.next=3,ae("clientData/getMarkedPosts?username=".concat(encodeURIComponent(c)));case 3:return t=e.sent,r=t.markedPosts,e.abrupt("return",r);case 6:return e.abrupt("return",[]);case 7:case"end":return e.stop()}}),e)}))),[o,c]),E=Object(n.useCallback)(Object(w.a)(x.a.mark((function e(){var t,r,n,a,o,l,s,i,p,d,f,m=arguments;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=m.length>0&&void 0!==m[0]&&m[0],r=m.length>1&&void 0!==m[1]&&m[1],n=m.length>2&&void 0!==m[2]&&m[2],!t){e.next=9;break}return e.next=6,j();case 6:e.t0=e.sent,e.next=10;break;case 9:e.t0={};case 10:if(a=e.t0,o=a.threads,!r){e.next=18;break}return e.next=15,y();case 15:e.t1=e.sent,e.next=19;break;case 18:e.t1=null;case 19:if(l=e.t1,o=o||u.current.threads,o=n?u.current.newThreads.concat(o):o,s=n?[]:u.current.newThreads,l&&(i=l.reduce((function(e,t){return Mt({},e,Object($.a)({},t.id,t.type))}),{}),o=o.map((function(e){return Mt({},e,{markType:i[e.threadId]||"unmarked"})}))),p=o.reduce((function(e,t){return e[t.threadId]=t.posts.reduce((function(e,t){return Math.max(t.id,e)}),0),e}),{}),d=Object(Rt.a)(Date.now(),18),o=(o=o.filter((function(e){var t=+e.threadId,r=e.posts.find((function(e){return e.id===t})),n=Object(nt.a)(r.date);return Object(Bt.a)(d,n)}))).sort((function(e,t){return p[t.threadId]-p[e.threadId]})).sort((function(e,t){return"pinned"===e.markType?-1:"pinned"===t.markType?1:0})),u.current.threads=o,u.current.newThreads=s,!l){e.next=41;break}if(!(f=l.filter((function(e){return!p[e.id]})).map((function(e){return e.id}))).length){e.next=41;break}return e.prev=33,e.next=36,ae("clientData/markPost",{method:"POST",body:{username:c,postId:f.join(","),type:"unmarked"}});case 36:e.next=41;break;case 38:e.prev=38,e.t2=e.catch(33),console.error("Error unmarking old posts.",e.t2);case 41:b(Mt({},u.current));case 42:case"end":return e.stop()}}),e,null,[[33,38]])}))),[y,c]),j=function(){var e=Object(w.a)(x.a.mark((function e(t){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ae("getChatty".concat(t>0?"?count=".concat(t):""));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.eventType,r=e.eventData;if("newPost"===t){var n=r.post;if(n.parentId){var a="".concat(n.threadId),o=function(e){return e.threadId===a?Mt({},e,{posts:[].concat(Object(ut.a)(e.posts),[n])}):e};u.current.threads=u.current.threads.map(o),u.current.newThreads=u.current.newThreads.map(o)}else u.current.newThreads=[].concat(Object(ut.a)(u.current.newThreads),[{threadId:"".concat(n.id),posts:[n]}])}else if("categoryChange"===t){var c=r.postId,l=r.category,s=function(e){if(e.posts.find((function(e){return e.id===c}))){var t=e.posts.map((function(e){return e.id===c?Mt({},e,{category:l}):e}));return Mt({},e,{posts:t})}return e};u.current.threads=u.current.threads.map(s),u.current.newThreads=u.current.newThreads.map(s)}else if("lolCountsUpdate"===t){var i=r.updates,p=i.reduce((function(e,t){var r=t.postId,n=t.tag,a=t.count;return Mt({},e,Object($.a)({},r,{tag:n,count:a}))}),{}),d=function(e){if(e.posts.find((function(e){return p[e.id]}))){var t=e.posts.map((function(e){var t=p[e.id];return t?Mt({},e,{lols:(e.lols||[]).filter((function(e){return e.tag!==t.tag})).concat([t])}):e}));return Mt({},e,{posts:t})}return e};u.current.threads=u.current.threads.map(d),u.current.newThreads=u.current.newThreads.map(d)}else console.debug("Unhandled event type:",e)};Object(n.useEffect)((function(){var e=function(){var t=Object(w.a)(x.a.mark((function t(){var r,n;return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,s("async"),t.next=4,ae("getNewestEventId");case 4:return r=t.sent,n=r.eventId,t.next=8,E(!0,!0,!1);case 8:O(n),t.next=16;break;case 11:t.prev=11,t.t0=t.catch(0),i("Error loading chatty. Content may not be current.",{variant:"error"}),console.error("Exception while doing full reload.",t.t0),setTimeout((function(){return e()}),3e4);case 16:return t.prev=16,s(!1),t.finish(16);case 19:case"end":return t.stop()}}),t,null,[[0,11,16,19]])})));return function(){return t.apply(this,arguments)}}();0===v&&e()}),[v]),Object(n.useEffect)((function(){var e=!0,t=function(){var r=Object(w.a)(x.a.mark((function r(){var n,a,o,c;return x.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!e||!v){r.next=29;break}return r.prev=1,r.next=4,ae("waitForEvent?lastEventId=".concat(v));case 4:if(n=r.sent,a=n.lastEventId,o=n.events,c=n.error,!e){r.next=22;break}if(c){r.next=19;break}if(!(a>v)){r.next=16;break}o.forEach((function(e){return k(e)})),O(a),b(Mt({},u.current)),r.next=17;break;case 16:return r.abrupt("return",t(v));case 17:r.next=22;break;case 19:console.error("Error from API:waitForLastEvent call.",c),i("Error receiving events. Reloading full chatty.",{variant:"error"}),O(0);case 22:r.next=29;break;case 24:r.prev=24,r.t0=r.catch(1),i("Error receiving events. Reloading full chatty.",{variant:"error"}),console.error("Exception from API:waitForLastEvent call.",r.t0),O(0);case 29:case"end":return r.stop()}}),r,null,[[1,24]])})));return function(){return r.apply(this,arguments)}}();return t(v),function(){return e=!1}}),[v]),Object(n.useEffect)((function(){var e=function(){var e=Object(w.a)(x.a.mark((function e(){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u.current.lastUsername=c,e.prev=1,s("async"),b({threads:[],newThreads:[]}),e.next=6,E(!0,!0,!0);case 6:return e.prev=6,s(!1),e.finish(6);case 9:case"end":return e.stop()}}),e,null,[[1,,6,9]])})));return function(){return e.apply(this,arguments)}}();c!==u.current.lastUsername&&e()}),[c,s,E]);var C=Object(n.useCallback)((function(){return E(!1,!1,!0)}),[E]),S=Object(n.useMemo)((function(){return Mt({},m,{refreshChatty:C})}),[m,C]);return a.a.createElement(W.Provider,{value:S},t)},zt=(r(206),r(207),r(208),r(277));var _t=Object(V.a)({progress:{zIndex:9999,position:"fixed",top:0,width:"100vw"}}),Jt=function(e){var t=e.loading,r=_t();return"async"!==t?null:a.a.createElement(zt.a,{className:r.progress,color:"secondary"})},Wt=r(278);var Vt=Object(V.a)({container:{zIndex:99999,position:"fixed",top:0,left:0,bottom:0,right:0,backgroundColor:"rgba(0, 0, 0, 0.2)"},progress:{position:"absolute",top:"calc(50% - 60px)",left:"calc(50% - 60px)"}}),Ht=function(e){var t=e.loading,r=Vt();return"sync"!==t?null:a.a.createElement("div",{className:r.container},a.a.createElement(Wt.a,{className:r.progress,size:60,thickness:4,color:"secondary"}))},At=r(85);var qt=function(e){var t=e.children,r=Object(n.useState)(!1),o=Object(p.a)(r,2),c=o[0],l=o[1],s=Object(At.useSnackbar)().enqueueSnackbar,i=Object(n.useMemo)((function(){return{setLoading:l,showSnackbar:s}}),[s]);return a.a.createElement(I.Provider,{value:i},a.a.createElement(Ht,{loading:c}),a.a.createElement(Jt,{loading:c}),t)},Kt=a.a.createContext({});function Gt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Qt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Gt(r,!0).forEach((function(t){Object($.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Gt(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Xt={filteredTerms:[],filteredUsers:[],showCollapsed:!1,showFilteredTerms:!1,showFilteredUsers:!1},Yt=function(e){var t=e.children,r=Object(n.useContext)(Kt),o=r.clientData,c=r.updateClientData,l=Object(n.useState)(Xt),s=Object(p.a)(l,2),i=s[0],u=s[1],d=Object(n.useContext)(I).showSnackbar,f=Object(n.useCallback)(function(){var e=Object(w.a)(x.a.mark((function e(t){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c("filterSettings",t);case 3:e.next=9;break;case 5:e.prev=5,e.t0=e.catch(0),console.error("Error updating clientData.filterSettings."),d("Error updating filter settings, changes may have been lost.",{variant:"error"});case 9:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}(),[d,c]);Object(n.useEffect)((function(){try{if(o&&o.filterSettings){var e=o.filterSettings;u({filteredTerms:(e.filteredTerms||[]).map((function(e){return{text:e,regex:new RegExp(e,"mi")}})),filteredUsers:(e.filteredUsers||[]).map((function(e){return{text:e,regex:new RegExp(e,"mi")}})),showCollapsed:!!e.showCollapsed,showFilteredTerms:!!e.showFilteredTerms,showFilteredUsers:!!e.showFilteredUsers})}}catch(t){console.error("Error parsing clientData.filterSettings, resetting to default."),d("Error loading filter settings, resetting to default.",{variant:"error"}),f(Xt),u(Xt)}}),[o,d,f]);var m=Object(n.useCallback)((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,r=i.showCollapsed,n=i.showFilteredUsers,a=i.filteredUsers,o=i.showFilteredTerms,c=i.filteredTerms;return!(!r&&"collapsed"===e.markType)&&(!(!n&&a.some((function(e){return e.regex.test(t.author)})))&&!(!o&&c.some((function(e){return e.regex.test(Et(t.body))}))))}),[i]),b=Object(n.useCallback)(function(){var e=Object(w.a)(x.a.mark((function e(t){var r,n;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=Qt({},i,{},t),n=Qt({},r,{filteredTerms:r.filteredTerms.map((function(e){return e.text})),filteredUsers:r.filteredUsers.map((function(e){return e.text}))}),f(n),u(r);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[i,f]),h=Object(n.useMemo)((function(){return{filterSettings:i,updateFilterSettings:b,isPostVisible:m}}),[i,m,b]);return a.a.createElement(xe.Provider,{value:h},t)},Zt=r(39).a({});function $t(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function er(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?$t(r,!0).forEach((function(t){Object($.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$t(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var tr="nixxedchatty",rr=function(e){var t=e.children,r=Object(n.useState)({}),o=Object(p.a)(r,2),c=o[0],l=o[1],s=Object(n.useContext)(T),i=s.isLoggedIn,u=s.username,d=Object(n.useContext)(I).showSnackbar,f=Object(n.useCallback)(function(){var e=Object(w.a)(x.a.mark((function e(t,r){var n,a,o,l;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=er({},c),t&&(n[t]=r),a=JSON.stringify(n),o={client:tr,username:encodeURIComponent(u),data:a},e.next=7,ae("clientData/setClientData",{method:"POST",body:o});case 7:(l=e.sent).error&&(d("Error updating user preferences.",{variant:"error"}),console.error("Error setting client data",l)),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),d("Error updating user preferences.",{variant:"error"}),console.error("Error setting client data",e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t,r){return e.apply(this,arguments)}}(),[c,d,u]);Object(n.useEffect)((function(){(function(){var e=Object(w.a)(x.a.mark((function e(){var t,r,n,a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!i){e.next=18;break}return e.prev=1,t=te.a.stringify({client:tr,username:encodeURIComponent(u)}),e.next=5,ae("clientData/getClientData?".concat(t));case 5:r=e.sent,n=r.data,a=JSON.parse(n||"{}"),l(a),e.next=16;break;case 11:e.prev=11,e.t0=e.catch(1),d("Error loading user preferences.",{variant:"error"}),console.error("Error loading client data",e.t0),l({});case 16:e.next=19;break;case 18:l({});case 19:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(){return e.apply(this,arguments)}})()()}),[i,d,u]);var m=Object(n.useMemo)((function(){return{clientData:c,updateClientData:f}}),[c,f]);return i&&!c?null:a.a.createElement(Kt.Provider,{value:m},t)};var nr;nr=function(){return a.a.createElement(u.b,{history:Zt},a.a.createElement(l.a,{theme:i},a.a.createElement(At.SnackbarProvider,null,a.a.createElement(qt,null,a.a.createElement(Ft,null,a.a.createElement(rr,null,a.a.createElement(Yt,null,a.a.createElement(Ut,null,a.a.createElement(Nt,null)))))))))},c.a.render(a.a.createElement(nr,null),document.getElementById("root"))}},[[171,1,2]]]);
//# sourceMappingURL=main.63f99243.chunk.js.map